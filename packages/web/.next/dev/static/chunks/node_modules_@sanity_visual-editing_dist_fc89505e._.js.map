{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js","sources":["file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/util/getNodeIcon.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/PopoverPortal.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/telemetry/TelemetryContext.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/telemetry/useTelemetry.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/overlay-components/components/InsertMenu.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/overlay-components/components/PointerEvents.tsx"],"sourcesContent":["import {\n  BlockContentIcon,\n  CheckmarkCircleIcon,\n  CubeIcon,\n  ImageIcon,\n  NumberIcon,\n  StringIcon,\n  ThListIcon,\n} from '@sanity/icons'\nimport type {\n  SchemaArrayItem,\n  SchemaNumberNode,\n  SchemaObjectField,\n  SchemaStringNode,\n  SchemaUnionOption,\n} from '@sanity/presentation-comlink'\n\ntype Option =\n  | SchemaNumberNode\n  | SchemaStringNode\n  | SchemaArrayItem\n  | SchemaObjectField\n  | SchemaUnionOption\n\nexport function getNodeIcon(option: Option | undefined): React.JSX.Element {\n  if (!option) return <CubeIcon />\n\n  if (option.type === 'string') {\n    return <StringIcon />\n  }\n\n  if (option.type === 'number') {\n    return <NumberIcon />\n  }\n\n  const {value: node} = option\n\n  if ('icon' in option && option.icon) {\n    return <div dangerouslySetInnerHTML={{__html: option.icon}} />\n  }\n\n  const {type} = node\n\n  if (type === 'string') {\n    return <StringIcon />\n  }\n\n  if (type === 'boolean') {\n    return <CheckmarkCircleIcon />\n  }\n\n  if (type === 'number') {\n    return <NumberIcon />\n  }\n\n  if (type === 'array' || type === 'union') {\n    const of = Array.isArray(node.of) ? node.of : [node.of]\n    if (of.some((n) => 'name' in n && n.name === 'block')) {\n      return <BlockContentIcon />\n    }\n    return <ThListIcon />\n  }\n\n  if (type === 'object') {\n    if (option.name === 'image') {\n      return <ImageIcon />\n    }\n    if (option.name === 'block') {\n      return <StringIcon />\n    }\n  }\n\n  return <CubeIcon />\n}\n","import {Portal} from '@sanity/ui/_visual-editing'\nimport {type FunctionComponent, type MouseEvent} from 'react'\nimport {css, styled} from 'styled-components'\n\nconst scrollBlockStyles = css`\n  overflow-y: scroll;\n  overscroll-behavior: contain;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n\n  &:before {\n    content: '';\n    display: block;\n    height: calc(100% + 1px);\n    position: absolute;\n    top: 0;\n    width: 100%;\n    z-index: -1;\n  }\n`\n\nconst PortalContainer = styled.div<{$blockScroll: boolean}>`\n  height: 100%;\n  inset: 0;\n  pointer-events: all;\n  position: fixed;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  ${(props) => props.$blockScroll && scrollBlockStyles}\n`\nconst PortalBackground = styled.div`\n  background: transparent;\n  height: 100%;\n  inset: 0;\n  position: absolute;\n  width: 100%;\n`\n\ntype PopoverPortalProps = {\n  children?: React.ReactNode\n  onDismiss?: () => void\n  setBoundaryElement?: (element: HTMLDivElement) => void\n  blockScroll?: boolean\n}\n\nexport const PopoverPortal: FunctionComponent<PopoverPortalProps> = (props) => {\n  return (\n    <Portal>\n      <PopoverBackground {...props} />\n    </Portal>\n  )\n}\n\nexport const PopoverBackground: FunctionComponent<{\n  children?: React.ReactNode\n  onDismiss?: () => void\n  setBoundaryElement?: (element: HTMLDivElement) => void\n  blockScroll?: boolean\n}> = (props) => {\n  const {children, onDismiss, setBoundaryElement, blockScroll = true} = props\n\n  // Prevent the event from propagating to the window, so that the controller's\n  // `handleBlur` listener is not triggered. This is needed to prevent the\n  // context menu from being dismissed when some click causes parent elements to\n  // re-render, and the data-attribute method of preventing propagation fails.\n  const handleClick = (event: MouseEvent) => {\n    event.stopPropagation()\n  }\n\n  return (\n    <PortalContainer\n      data-sanity-overlay-element\n      ref={setBoundaryElement}\n      onClick={handleClick}\n      $blockScroll={blockScroll}\n    >\n      <PortalBackground\n        onMouseDownCapture={() => {\n          onDismiss?.()\n        }}\n      />\n      {children}\n    </PortalContainer>\n  )\n}\n","import {defineEvent} from '@sanity/telemetry'\nimport {createContext} from 'react'\n\nexport const events = {\n  'Visual Editing Drag Sequence Completed': defineEvent({\n    name: 'Visual Editing Drag Sequence Completed',\n    description: 'An array is successfully reordered using drag and drop.',\n    version: 1,\n  }),\n  'Visual Editing Drag Minimap Enabled': defineEvent({\n    name: 'Visual Editing Drag Minimap Enabled',\n    description: 'The zoomed-out minimap view is enabled during a drag sequence.',\n    version: 1,\n  }),\n  'Visual Editing Context Menu Item Removed': defineEvent({\n    name: 'Visual Editing Context Menu Item Removed',\n    description: 'An item is removed using the Context Menu.',\n    version: 1,\n  }),\n  'Visual Editing Context Menu Item Duplicated': defineEvent({\n    name: 'Visual Editing Context Menu Item Duplicated',\n    description: 'An item is duplicated using the Context Menu.',\n    version: 1,\n  }),\n  'Visual Editing Context Menu Item Moved': defineEvent({\n    name: 'Visual Editing Context Menu Item Moved',\n    description: 'An item is moved using the Context Menu.',\n    version: 1,\n  }),\n  'Visual Editing Context Menu Item Inserted': defineEvent({\n    name: 'Visual Editing Context Menu Item Inserted',\n    description: 'An item is inserted using the Context Menu.',\n    version: 1,\n  }),\n  'Visual Editing Insert Menu Item Inserted': defineEvent({\n    name: 'Visual Editing Insert Menu Item Inserted',\n    description: 'An item is inserted using the Insert Menu.',\n    version: 1,\n  }),\n  'Visual Editing Overlay Clicked': defineEvent({\n    name: 'Visual Editing Overlay Clicked',\n    description: 'An Overlay is clicked.',\n    version: 1,\n  }),\n}\n\ntype EventDataMap = {\n  [K in keyof typeof events]: (typeof events)[K] extends ReturnType<typeof defineEvent<infer T>>\n    ? T\n    : never\n}\n\nexport type TelemetryEventNames = keyof typeof events\n\nexport type TelemetryContextValue = <K extends keyof typeof events>(\n  name: K,\n  data: EventDataMap[K] extends void ? null | undefined : EventDataMap[K],\n) => void\n\nexport const TelemetryContext = createContext<TelemetryContextValue | undefined>(undefined)\n","import {useContext} from 'react'\nimport {TelemetryContext, type TelemetryContextValue} from './TelemetryContext'\n\nexport function useTelemetry(): TelemetryContextValue {\n  const context = useContext(TelemetryContext)\n\n  if (!context) {\n    throw new Error('Telemetry context is missing')\n  }\n\n  return context\n}\n","import type {InsertMenuOptions} from '@sanity/insert-menu'\nimport {InsertMenu as SanityInsertMenu} from '@sanity/insert-menu'\nimport type {SchemaUnionNode} from '@sanity/presentation-comlink'\nimport type {SchemaType} from '@sanity/types'\nimport {Popover} from '@sanity/ui/_visual-editing'\nimport {type FunctionComponent} from 'react'\nimport {PopoverPortal} from '../../ui/PopoverPortal'\nimport {getNodeIcon} from '../../util/getNodeIcon'\n\n// @todo How can this be localised?\nconst labels = {\n  'insert-menu.filter.all-items': 'All',\n  'insert-menu.search.no-results': 'No results',\n  'insert-menu.search.placeholder': 'Filter typesâ€¦',\n  'insert-menu.toggle-grid-view.tooltip': 'Toggle grid view',\n  'insert-menu.toggle-list-view.tooltip': 'Toggle list view',\n} as const\n\nexport interface InsertMenuProps {\n  node: SchemaUnionNode\n  onSelect: (schemaType: SchemaType) => void\n}\n\nexport const InsertMenu: FunctionComponent<InsertMenuProps> = (props) => {\n  const {node, onSelect} = props\n\n  const insertMenuOptions = node.options?.insertMenu || {}\n\n  const views: InsertMenuOptions['views'] = insertMenuOptions.views?.map((view) => {\n    // Map the `previewImageUrls` that Presentation already resolved and\n    // serialized back to a function so that InsertMenu can \"resolve\" them\n    if (view.name === 'grid') {\n      return {\n        ...view,\n        previewImageUrl: (name) => view.previewImageUrls?.[name],\n      }\n    }\n    return view\n  })\n\n  return (\n    <SanityInsertMenu\n      {...insertMenuOptions}\n      labels={labels}\n      // @ts-expect-error -- @todo map typings\n      schemaTypes={node.of.map((type) => ({\n        ...type,\n        icon: getNodeIcon(type),\n      }))}\n      onSelect={onSelect}\n      views={views}\n    />\n  )\n}\n\nexport interface InsertMenuPopoverProps extends InsertMenuProps {\n  onDismiss: () => void\n  referenceElement?: HTMLElement | null\n}\n\nexport const InsertMenuPopover: FunctionComponent<InsertMenuPopoverProps> = (props) => {\n  const {node, onDismiss, onSelect, referenceElement} = props\n\n  const popoverContent = <InsertMenu node={node} onSelect={onSelect} />\n\n  const insertMenuOptions = node.options?.insertMenu || {}\n\n  // If the grid view is not enabled, the popover should fit the content. If it\n  // is enabled, the popover width needs to be 'forced' to some arbitrary amount\n  // to prevent the grid from collapsing to a single column. The '0' size allows\n  // for a two column layout\n  const width = insertMenuOptions.views?.some((view) => view.name === 'grid') ? 0 : undefined\n\n  return (\n    <PopoverPortal onDismiss={onDismiss}>\n      <Popover\n        animate={true}\n        constrainSize\n        content={popoverContent}\n        fallbackPlacements={['bottom']}\n        open\n        placement={'top'}\n        preventOverflow\n        referenceElement={referenceElement}\n        width={width}\n      />\n    </PopoverPortal>\n  )\n}\n","import type {FunctionComponent, HTMLAttributes, PropsWithChildren} from 'react'\n\nexport const PointerEvents: FunctionComponent<\n  PropsWithChildren<HTMLAttributes<HTMLDivElement>>\n> = ({children, style, ...rest}) => {\n  return (\n    <div style={{...style, pointerEvents: 'all'}} data-sanity-overlay-element {...rest}>\n      {children}\n    </div>\n  )\n}\n"],"names":["getNodeIcon","option","type","value","node","icon","__html","Array","isArray","of","some","n","name","scrollBlockStyles","css","PortalContainer","styled","div","props","$blockScroll","PortalBackground","PopoverPortal","$","_c","t0","PopoverBackground","children","onDismiss","setBoundaryElement","blockScroll","undefined","handleClick","_temp","t1","t2","event","stopPropagation","events","defineEvent","description","version","TelemetryContext","createContext","useTelemetry","context","useContext","Error","labels","InsertMenu","onSelect","options","insertMenu","insertMenuOptions","views","map","_temp2","t3","SanityInsertMenu","InsertMenuPopover","referenceElement","popoverContent","width","_temp3","Symbol","for","view","previewImageUrl","previewImageUrls","PointerEvents","rest","style","pointerEvents"],"mappings":"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"}},
    {"offset": {"line": 273, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@sanity/visual-editing/dist/optimistic/index.js","sources":["file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/optimistic/state/documentMutator.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/optimistic/state/datasetMutator.ts"],"sourcesContent":["import type {SanityClient} from '@sanity/client'\nimport {SanityEncoder, type Transaction} from '@sanity/mutate'\nimport {\n  documentMutatorMachine,\n  type DocumentMutatorMachineParentEvent,\n} from '@sanity/mutate/_unstable_machine'\nimport {enqueueActions, fromPromise} from 'xstate'\nimport type {VisualEditingNode} from '../../types'\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const createDocumentMutator = (comlink: VisualEditingNode) => {\n  const fetchSnapshot = fromPromise(\n    async ({input, signal}: {input: {id: string; client: SanityClient}; signal: AbortSignal}) => {\n      const {id} = input\n      const {snapshot} = await comlink.fetch(\n        'visual-editing/fetch-snapshot',\n        {documentId: id},\n        {\n          signal,\n        },\n      )\n      return snapshot\n    },\n  )\n\n  const submitMutations = fromPromise(\n    async ({input}: {input: {client: SanityClient; transactions: Transaction[]}}) => {\n      const {transactions} = input\n      for (const transaction of transactions) {\n        const data = SanityEncoder.encodeTransaction(transaction)\n        return comlink.post('visual-editing/mutate', data)\n      }\n    },\n  )\n\n  return documentMutatorMachine.provide({\n    actions: {\n      'send sync event to parent': enqueueActions(({enqueue}) => {\n        // Original action provided by the `documentMutatorMachine`\n        enqueue.sendParent(\n          ({context}) =>\n            ({\n              type: 'sync',\n              id: context.id,\n              document: context.remote!,\n            }) satisfies DocumentMutatorMachineParentEvent,\n        )\n        // Additional action so that we can determine when the snapshot is ready\n        enqueue.emit(({context}) => ({type: 'ready', snapshot: context.local}))\n      }),\n    },\n    actors: {\n      'fetch remote snapshot': fetchSnapshot,\n      'submit mutations as transactions': submitMutations,\n    },\n  })\n}\n","/**\n * The logic here is intended to live inside a preview iframe, and listen to events from the parent frame.\n * It also supports running in a \"detached\" mode, where it has to setup authenticated EventSource conenctions and perform data fetching itself.\n */\n\nimport {type SanityClient} from '@sanity/client'\nimport {\n  createSharedListener,\n  documentMutatorMachine,\n  type DocumentMutatorMachineInput,\n  type DocumentMutatorMachineParentEvent,\n} from '@sanity/mutate/_unstable_machine'\nimport {assertEvent, assign, emit, setup, stopChild, type ActorRefFrom} from 'xstate'\nimport type {VisualEditingNode} from '../../types'\nimport {createDocumentMutator} from './documentMutator'\n\nexport interface DatasetMutatorMachineInput extends Omit<DocumentMutatorMachineInput, 'id'> {\n  client: SanityClient\n  /** A shared listener can be provided, if not it'll be created using `client.listen()` */\n  sharedListener?: ReturnType<typeof createSharedListener>\n}\n\nexport const datasetMutatorMachine = setup({\n  types: {} as {\n    context: {\n      client: SanityClient\n      /** A shared listener can be provided, if not it'll be created using `client.listen()` */\n      sharedListener?: ReturnType<typeof createSharedListener>\n      documents: Record<string, ActorRefFrom<ReturnType<typeof createDocumentMutator>>>\n    }\n    events:\n      | {type: 'observe'; documentId: string}\n      | {type: 'unobserve'; documentId: string}\n      | {type: 'add document actor'; documentId: string}\n      | {type: 'stop document actor'; documentId: string}\n      | DocumentMutatorMachineParentEvent\n    input: DatasetMutatorMachineInput\n    emitted: DocumentMutatorMachineParentEvent\n  },\n  actions: {\n    'emit sync event': emit(({event}) => {\n      assertEvent(event, 'sync')\n      return event\n    }),\n    'emit mutation event': emit(({event}) => {\n      assertEvent(event, 'mutation')\n      return event\n    }),\n    'emit rebased event': emit(({event}) => {\n      assertEvent(event, ['rebased.local', 'rebased.remote'])\n      return event\n    }),\n    'emit pristine event': emit(({event}) => {\n      assertEvent(event, ['pristine'])\n      return event\n    }),\n    'add document actor': assign({\n      documents: ({context, event, spawn}) => {\n        assertEvent(event, 'observe')\n        const id = event.documentId\n        // Adding the same documentId multiple times is a no-op\n        if (context.documents[id]) return context.documents\n        return {\n          ...context.documents,\n          [id]: spawn('documentMutatorMachine', {\n            input: {\n              id,\n              client: context.client,\n              sharedListener: context.sharedListener || createSharedListener(context.client),\n            },\n            id,\n          }),\n        }\n      },\n    }),\n    'stop remote snapshot': stopChild(({context, event}) => {\n      assertEvent(event, 'unobserve')\n      return context.documents[event.documentId]!\n    }),\n    'remove remote snapshot from context': assign({\n      documents: ({context, event}) => {\n        assertEvent(event, 'unobserve')\n        // Removing a non-existing documentId is a no-op\n        if (!context.documents[event.documentId]) return context.documents\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const {[event.documentId]: _, ...documents} = context.documents\n        return documents\n      },\n    }),\n  },\n  actors: {\n    documentMutatorMachine,\n  },\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QBsD2BjAhsgIhgrgLZgB2ALgMTICWsZpA2gAwC6ioADqrNWdaiXYgAHogC0ADgBMAOgkA2ACyKArBICcTdfKXSANCACeiFQHYZpgMxWV800yYqp6gIyn5AXw8G0WXAWJyCnwSGjpGViEuHj4BIVEEKUt5OSlFU1smFwkFW0sDY0T1GRUXRXkXKVN7HSYJJkUvHwxsPHQiUjIZDgAnWj4SMApCfDJMemY2JBBo3n5BaYSXeVlbKRUsiXdFSxcXfKNERSqZTbr1zVMJNyaQX1aAzpkIah6yQwp0VEJCXkmo7hzOKLRDLFwyFxaSzXKTOKQudSKCQFRDOczqCSWJjwjbHCQqRFebwgEioCBwIT3fztQJkAExebxcQuFEIZaWGRIrF7dSXKTyFSNYlUtodcjdPp0aiDelAhagBLpVmWAmc46mNwSZTyLQuFS3EWPcUvN6FTiA2LykSoq6c6wbCqVUzparKioyRFVfkq1zqNSWIkeIA */\n  id: 'dataset-mutator',\n  context: ({input}) => ({\n    documents: {},\n    client: input.client,\n    sharedListener: input.sharedListener,\n  }),\n\n  on: {\n    'sync': {actions: ['emit sync event']},\n    'mutation': {actions: ['emit mutation event']},\n    'rebased.*': {actions: ['emit rebased event']},\n    'pristine': {actions: ['emit pristine event']},\n    'observe': {\n      actions: ['add document actor'],\n    },\n    'unobserve': {\n      actions: ['stop remote snapshot', 'remove remote snapshot from context'],\n    },\n  },\n\n  initial: 'pristine',\n\n  states: {\n    pristine: {},\n  },\n})\n\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport const createDatasetMutator = (comlink: VisualEditingNode) => {\n  return datasetMutatorMachine.provide({\n    actors: {\n      documentMutatorMachine: createDocumentMutator(comlink),\n    },\n  })\n}\n"],"names":["createDocumentMutator","comlink","fetchSnapshot","fromPromise","input","signal","id","snapshot","fetch","documentId","submitMutations","transactions","transaction","data","SanityEncoder","encodeTransaction","post","documentMutatorMachine","provide","actions","enqueueActions","enqueue","sendParent","context","type","document","remote","emit","local","actors","datasetMutatorMachine","setup","types","event","assertEvent","assign","documents","spawn","client","sharedListener","createSharedListener","stopChild","_","createMachine","on","initial","states","pristine","createDatasetMutator"],"mappings":"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"}},
    {"offset": {"line": 421, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@sanity/visual-editing/dist/react/index.js","sources":["file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/History.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/Meta.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/util/useDragEvents.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/schema/SchemaContext.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/schema/useSchema.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/context-menu/contextMenuItems.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/context-menu/ContextMenu.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/util/getLinkHref.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/preview/PreviewSnapshotsContext.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/preview/usePreviewSnapshots.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/ElementOverlay.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/OverlayDragGroupRect.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/OverlayDragInsertMarker.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/OverlayDragPreview.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/OverlayMinimapPrompt.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/elementsReducer.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/overlayStateReducer.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/preview/PreviewSnapshotsProvider.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/schema/SchemaProvider.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/shared-state/SharedStateProvider.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/telemetry/TelemetryProvider.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/useController.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/usePerspectiveSync.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/useReportDocuments.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/Overlays.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/Refresh.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/useComlink.tsx","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/optimistic/state/createSharedListener.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/useDatasetMutator.ts","file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/VisualEditing.tsx"],"sourcesContent":["import {useEffect, type FunctionComponent} from 'react'\nimport type {HistoryAdapter, VisualEditingNode} from '../types'\n\n/**\n * @internal\n */\nexport const History: FunctionComponent<{\n  comlink: VisualEditingNode\n  history?: HistoryAdapter\n}> = (props) => {\n  const {comlink, history} = props\n\n  useEffect(() => {\n    return comlink?.on('presentation/navigate', (data) => {\n      history?.update(data)\n    })\n  }, [comlink, history])\n\n  useEffect(() => {\n    if (history) {\n      return history.subscribe((update) => {\n        update.title = update.title || document.title\n        comlink?.post('visual-editing/navigate', update)\n      })\n    }\n    return\n  }, [comlink, history])\n\n  return null\n}\n","import {useEffect, type FunctionComponent} from 'react'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * @internal\n */\nexport const Meta: FunctionComponent<{\n  comlink: VisualEditingNode\n}> = (props) => {\n  const {comlink} = props\n\n  useEffect(() => {\n    const sendMeta = () => {\n      comlink.post('visual-editing/meta', {title: document.title})\n    }\n\n    const observer = new MutationObserver(([mutation]) => {\n      if (mutation.target.nodeName === 'TITLE') {\n        sendMeta()\n      }\n    })\n\n    observer.observe(document.head, {\n      subtree: true,\n      characterData: true,\n      childList: true,\n    })\n\n    sendMeta()\n\n    return () => observer.disconnect()\n  }, [comlink])\n\n  return null\n}\n","import {at, insert, remove} from '@sanity/mutate'\nimport {get as getFromPath} from '@sanity/util/paths'\nimport {useCallback, useEffect} from 'react'\nimport {useDocuments} from '../react/useDocuments'\nimport type {DragEndEvent, DragInsertPosition} from '../types'\nimport {getArrayItemKeyAndParentPath} from './mutations'\n\n// Finds the node that the drag end event was relative to, and the relative\n// position the new element should be inserted in. If the reference node was\n// \"top\" or \"left\", we insert \"after\". If it was \"bottom\" or \"right\", we insert\n// \"before\".\nfunction getReferenceNodeAndInsertPosition(position: DragInsertPosition) {\n  if (position) {\n    const {top, right, bottom, left} = position\n    if (left || top) {\n      return {node: (left ?? top)!.sanity, position: 'after' as const}\n    } else if (right || bottom) {\n      return {node: (right ?? bottom)!.sanity, position: 'before' as const}\n    }\n  }\n  return undefined\n}\n\nexport function useDragEndEvents(): {\n  dispatchDragEndEvent: (event: DragEndEvent) => void\n} {\n  const {getDocument} = useDocuments()\n\n  useEffect(() => {\n    const handler = (e: CustomEvent<DragEndEvent>) => {\n      const {insertPosition, target, preventInsertDefault} = e.detail\n\n      if (preventInsertDefault) return\n\n      const reference = getReferenceNodeAndInsertPosition(insertPosition)\n      if (reference) {\n        const doc = getDocument(target.id)\n        // We must have access to the document actor in order to perform the\n        // necessary mutations. If this is undefined, something went wrong when\n        // resolving the currently in use documents\n        const {node, position} = reference\n        // Get the key of the element that was dragged\n        const {key: targetKey, hasExplicitKey} = getArrayItemKeyAndParentPath(target)\n        // Get the key of the reference element, and path to the parent array\n        const {path: arrayPath, key: referenceItemKey} = getArrayItemKeyAndParentPath(node)\n        // Don't patch if the keys match, as this means the item was only\n        // dragged to its existing position, i.e. not moved\n        if (arrayPath && referenceItemKey && referenceItemKey !== targetKey) {\n          doc.patch(async ({getSnapshot}) => {\n            const snapshot = await getSnapshot()\n            // Get the current value of the element we dragged, as we will need\n            // to clone this into the new position\n            const elementValue = getFromPath(snapshot, target.path)\n\n            if (hasExplicitKey) {\n              return [\n                // Remove the original dragged item\n                at(arrayPath, remove({_key: targetKey})),\n                // Insert the cloned dragged item into its new position\n                at(arrayPath, insert(elementValue, position, {_key: referenceItemKey})),\n              ]\n            } else {\n              // handle reordering for primitives\n              return [\n                // Remove the original dragged item\n                at(arrayPath, remove(~~targetKey)),\n                // Insert the cloned dragged item into its new position\n                at(\n                  arrayPath,\n                  insert(\n                    elementValue,\n                    position,\n                    // if target key is < reference, each item in the array's index will be one less due to the previous removal\n                    referenceItemKey > targetKey ? ~~referenceItemKey - 1 : ~~referenceItemKey,\n                  ),\n                ),\n              ]\n            }\n          })\n        }\n      }\n    }\n    window.addEventListener('sanity/dragEnd', handler as EventListener)\n    return () => {\n      window.removeEventListener('sanity/dragEnd', handler as EventListener)\n    }\n  }, [getDocument])\n\n  const dispatchDragEndEvent = useCallback((event: DragEndEvent) => {\n    const customEvent = new CustomEvent<DragEndEvent>('sanity/dragEnd', {\n      detail: event,\n      cancelable: true,\n    })\n    window.dispatchEvent(customEvent)\n  }, [])\n\n  return {dispatchDragEndEvent}\n}\n","import type {\n  DocumentSchema,\n  SanityNode,\n  SanityStegaNode,\n  TypeSchema,\n} from '@sanity/presentation-comlink'\nimport {createContext} from 'react'\nimport type {OverlayElementField, OverlayElementParent} from '../../types'\n\nexport interface SchemaContextValue {\n  getField: (node: SanityNode | SanityStegaNode) => {\n    field: OverlayElementField\n    parent: OverlayElementParent\n  }\n  getType: <T extends 'document' | 'type' = 'document'>(\n    node: SanityNode | SanityStegaNode | string,\n    type?: T,\n  ) => T extends 'document' ? DocumentSchema | undefined : TypeSchema | undefined\n}\n\nexport const SchemaContext = createContext<SchemaContextValue | null>(null)\n","import {useContext} from 'react'\nimport {SchemaContext, type SchemaContextValue} from './SchemaContext'\n\nexport function useSchema(): SchemaContextValue {\n  const context = useContext(SchemaContext)\n\n  if (!context) {\n    throw new Error('Schema context is missing')\n  }\n\n  return context\n}\n","import {\n  ArrowDownIcon,\n  ArrowUpIcon,\n  CopyIcon,\n  InsertAboveIcon,\n  InsertBelowIcon,\n  PublishIcon,\n  RemoveIcon,\n  SortIcon,\n  UnpublishIcon,\n} from '@sanity/icons'\nimport type {\n  SanityNode,\n  SchemaArrayItem,\n  SchemaNode,\n  SchemaUnionNode,\n  SchemaUnionOption,\n} from '@sanity/presentation-comlink'\nimport type {SchemaType} from '@sanity/types'\nimport {MenuGroup} from '@sanity/ui/_visual-editing'\nimport {type FunctionComponent} from 'react'\nimport type {OptimisticDocument} from '../../optimistic'\nimport {InsertMenu} from '../../overlay-components/components/InsertMenu'\nimport type {ContextMenuNode, OverlayElementField, OverlayElementParent} from '../../types'\nimport {getNodeIcon} from '../../util/getNodeIcon'\nimport {\n  getArrayDuplicatePatches,\n  getArrayInsertPatches,\n  getArrayMovePatches,\n  getArrayRemovePatches,\n} from '../../util/mutations'\n\nexport function getArrayRemoveAction(node: SanityNode, doc: OptimisticDocument): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () =>\n    doc.patch(async ({getSnapshot}) => getArrayRemovePatches(node, (await getSnapshot())!))\n}\n\nfunction getArrayInsertAction(\n  node: SanityNode,\n  doc: OptimisticDocument,\n  insertType: string,\n  position: 'before' | 'after',\n): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () => doc.patch(() => getArrayInsertPatches(node, insertType, position))\n}\n\nfunction getDuplicateAction(node: SanityNode, doc: OptimisticDocument): () => void {\n  if (!node.type) throw new Error('Node type is missing')\n  return () =>\n    doc.patch(async ({getSnapshot}) => getArrayDuplicatePatches(node, (await getSnapshot())!))\n}\n\nexport function getContextMenuItems(context: {\n  doc: OptimisticDocument\n  field: OverlayElementField\n  node: SanityNode\n  parent: OverlayElementParent\n}): Promise<ContextMenuNode[]> {\n  const {node, field, parent, doc} = context\n  if (field?.type === 'arrayItem') {\n    return getContextMenuArrayItems({node, field, doc})\n  }\n  if (parent?.type === 'union') {\n    return getContextMenuUnionItems({node, parent, doc})\n  }\n\n  return Promise.resolve([])\n}\n\nfunction getDuplicateItem(context: {doc: OptimisticDocument; node: SanityNode}) {\n  const {node, doc} = context\n  if (!doc) return []\n  return [\n    {\n      type: 'action' as const,\n      label: 'Duplicate',\n      icon: CopyIcon,\n      action: getDuplicateAction(node, doc),\n      telemetryEvent: 'Visual Editing Context Menu Item Duplicated' as const,\n    },\n  ]\n}\n\nfunction getRemoveItems(context: {doc: OptimisticDocument; node: SanityNode}) {\n  const {node, doc} = context\n  if (!doc) return []\n  return [\n    {\n      type: 'action' as const,\n      label: 'Remove',\n      icon: RemoveIcon,\n      action: getArrayRemoveAction(node, doc),\n      telemetryEvent: 'Visual Editing Context Menu Item Removed' as const,\n    },\n  ]\n}\n\nasync function getMoveItems(\n  context: {\n    doc: OptimisticDocument\n    node: SanityNode\n  },\n  withDivider = true,\n) {\n  const {node, doc} = context\n  if (!doc) return []\n\n  const items: ContextMenuNode[] = []\n  const groupItems: ContextMenuNode[] = []\n\n  const [moveUpPatches, moveDownPatches, moveFirstPatches, moveLastPatches] = await Promise.all([\n    getArrayMovePatches(node, doc, 'previous'),\n    getArrayMovePatches(node, doc, 'next'),\n    getArrayMovePatches(node, doc, 'first'),\n    getArrayMovePatches(node, doc, 'last'),\n  ])\n\n  if (moveFirstPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'To top',\n      icon: PublishIcon,\n      action: () => doc.patch(moveFirstPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveUpPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'Up',\n      icon: ArrowUpIcon,\n      action: () => doc.patch(moveUpPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveDownPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'Down',\n      icon: ArrowDownIcon,\n      action: () => doc.patch(moveDownPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n  if (moveLastPatches.length) {\n    groupItems.push({\n      type: 'action',\n      label: 'To bottom',\n      icon: UnpublishIcon,\n      action: () => doc.patch(moveLastPatches),\n      telemetryEvent: 'Visual Editing Context Menu Item Moved',\n    })\n  }\n\n  if (groupItems.length) {\n    items.push({\n      type: 'group',\n      label: 'Move',\n      icon: SortIcon,\n      items: groupItems,\n    })\n    if (withDivider) {\n      items.push({type: 'divider'})\n    }\n  }\n\n  return items\n}\n\nasync function getContextMenuArrayItems(context: {\n  doc: OptimisticDocument\n  field: SchemaArrayItem\n  node: SanityNode\n}): Promise<ContextMenuNode[]> {\n  const {node, field, doc} = context\n  const items: ContextMenuNode[] = []\n  items.push(...getDuplicateItem(context))\n  items.push(...getRemoveItems(context))\n  items.push(...(await getMoveItems(context)))\n\n  items.push({\n    type: 'action',\n    label: 'Insert before',\n    icon: InsertAboveIcon,\n    action: getArrayInsertAction(node, doc, field.name, 'before'),\n    telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n  })\n  items.push({\n    type: 'action',\n    label: 'Insert after',\n    icon: InsertBelowIcon,\n    action: getArrayInsertAction(node, doc, field.name, 'after'),\n    telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n  })\n\n  return items\n}\n\nconst InsertMenuWrapper: FunctionComponent<{\n  label: string\n  onSelect: (schemaType: SchemaType) => void\n  parent: SchemaUnionNode<SchemaNode>\n  width: number | undefined\n  boundaryElement: HTMLDivElement | null\n}> = (props) => {\n  const {label, parent, width, onSelect, boundaryElement} = props\n\n  return (\n    <MenuGroup\n      fontSize={1}\n      icon={InsertBelowIcon}\n      padding={2}\n      popover={{\n        arrow: false,\n        constrainSize: true,\n        floatingBoundary: boundaryElement,\n        padding: 0,\n        placement: 'right-start',\n        fallbackPlacements: [\n          'left-start',\n          'right',\n          'left',\n          'right-end',\n          'left-end',\n          'bottom',\n          'top',\n        ],\n        preventOverflow: true,\n        width,\n        __unstable_margins: [4, 4, 4, 4],\n      }}\n      space={2}\n      text={label}\n    >\n      <InsertMenu node={parent} onSelect={onSelect} />\n    </MenuGroup>\n  )\n}\n\nasync function getContextMenuUnionItems(context: {\n  doc: OptimisticDocument\n  node: SanityNode\n  parent: SchemaUnionNode<SchemaNode>\n}): Promise<ContextMenuNode[]> {\n  const {doc, node, parent} = context\n  const items: ContextMenuNode[] = []\n  items.push(...getDuplicateItem(context))\n  items.push(...getRemoveItems(context))\n  items.push(...(await getMoveItems(context)))\n\n  if (parent.options?.insertMenu) {\n    const insertMenuOptions = parent.options.insertMenu || {}\n    const width = insertMenuOptions.views?.some((view) => view.name === 'grid') ? 0 : undefined\n\n    items.push({\n      type: 'custom',\n      component: ({boundaryElement, sendTelemetry}) => {\n        const onSelect = (schemaType: SchemaType) => {\n          const action = getArrayInsertAction(node, doc, schemaType.name, 'before')\n          action()\n\n          sendTelemetry('Visual Editing Context Menu Item Inserted', null)\n        }\n        return (\n          <InsertMenuWrapper\n            label=\"Insert before\"\n            onSelect={onSelect}\n            parent={parent}\n            width={width}\n            boundaryElement={boundaryElement}\n          />\n        )\n      },\n    })\n\n    items.push({\n      type: 'custom',\n      component: ({boundaryElement, sendTelemetry}) => {\n        const onSelect = (schemaType: SchemaType) => {\n          const action = getArrayInsertAction(node, doc, schemaType.name, 'after')\n          action()\n\n          sendTelemetry('Visual Editing Context Menu Item Inserted', null)\n        }\n        return (\n          <InsertMenuWrapper\n            label=\"Insert after\"\n            onSelect={onSelect}\n            parent={parent}\n            width={width}\n            boundaryElement={boundaryElement}\n          />\n        )\n      },\n    })\n  } else {\n    items.push({\n      type: 'group',\n      label: 'Insert before',\n      icon: InsertAboveIcon,\n      items: (\n        parent.of.filter((item) => item.type === 'unionOption') as SchemaUnionOption<SchemaNode>[]\n      ).map((t) => {\n        return {\n          type: 'action' as const,\n          icon: getNodeIcon(t),\n          label: t.name === 'block' ? 'Paragraph' : t.title || t.name,\n          action: getArrayInsertAction(node, doc, t.name, 'before'),\n          telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n        }\n      }),\n    })\n    items.push({\n      type: 'group',\n      label: 'Insert after',\n      icon: InsertBelowIcon,\n      items: (\n        parent.of.filter((item) => item.type === 'unionOption') as SchemaUnionOption<SchemaNode>[]\n      ).map((t) => {\n        return {\n          type: 'action' as const,\n          label: t.name === 'block' ? 'Paragraph' : t.title || t.name,\n          icon: getNodeIcon(t),\n          action: getArrayInsertAction(node, doc, t.name, 'after'),\n          telemetryEvent: 'Visual Editing Context Menu Item Inserted',\n        }\n      }),\n    })\n  }\n\n  return items\n}\n","import {\n  Box,\n  Flex,\n  Menu,\n  MenuDivider,\n  MenuGroup,\n  MenuItem,\n  Popover,\n  Spinner,\n  Stack,\n  Text,\n  type PopoverMargins,\n} from '@sanity/ui/_visual-editing'\nimport {useCallback, useEffect, useMemo, useState, type FunctionComponent} from 'react'\nimport {useDocuments} from '../../react/useDocuments'\nimport type {ContextMenuNode, ContextMenuProps} from '../../types'\nimport {getNodeIcon} from '../../util/getNodeIcon'\nimport {PopoverPortal} from '../PopoverPortal'\nimport {useSchema} from '../schema/useSchema'\nimport {useTelemetry} from '../telemetry/useTelemetry'\nimport {getContextMenuItems} from './contextMenuItems'\n\nconst POPOVER_MARGINS: PopoverMargins = [-4, 4, -4, 4]\n\nfunction ContextMenuItem(props: {\n  node: ContextMenuNode\n  onDismiss?: () => void\n  boundaryElement: HTMLDivElement | null\n}) {\n  const {node, onDismiss, boundaryElement} = props\n  const sendTelemetry = useTelemetry()\n\n  const onClick = useCallback(() => {\n    if (node.type === 'action') {\n      node.action?.()\n      onDismiss?.()\n\n      if (node.telemetryEvent) {\n        sendTelemetry(node.telemetryEvent, null)\n      }\n    }\n  }, [node, onDismiss, sendTelemetry])\n\n  if (node.type === 'divider') {\n    return <MenuDivider />\n  }\n\n  if (node.type === 'action') {\n    return (\n      <MenuItem\n        fontSize={1}\n        hotkeys={node.hotkeys}\n        icon={node.icon}\n        padding={2}\n        space={2}\n        text={node.label}\n        disabled={!node.action}\n        onClick={onClick}\n      />\n    )\n  }\n\n  if (node.type === 'group') {\n    return (\n      <MenuGroup\n        fontSize={1}\n        icon={node.icon}\n        padding={2}\n        // @todo when this PR lands https://github.com/sanity-io/ui/pull/1454\n        // menu={{\n        //   padding: 0,\n        // }}\n        popover={{\n          arrow: false,\n          constrainSize: true,\n          placement: 'right-start',\n          fallbackPlacements: [\n            'left-start',\n            'right',\n            'left',\n            'right-end',\n            'left-end',\n            'bottom',\n            'top',\n          ],\n          preventOverflow: true,\n          __unstable_margins: POPOVER_MARGINS,\n        }}\n        space={2}\n        text={node.label}\n      >\n        {node.items.map((item, itemIndex) => (\n          <ContextMenuItem\n            key={itemIndex}\n            node={item}\n            onDismiss={onDismiss}\n            boundaryElement={boundaryElement}\n          />\n        ))}\n      </MenuGroup>\n    )\n  }\n\n  if (node.type === 'custom') {\n    const {component: Component} = node\n    return <Component boundaryElement={boundaryElement} sendTelemetry={sendTelemetry} />\n  }\n\n  return null\n}\n\nexport const ContextMenu: FunctionComponent<ContextMenuProps> = (props) => {\n  const {\n    node,\n    onDismiss,\n    position: {x, y},\n  } = props\n\n  const [boundaryElement, setBoundaryElement] = useState<HTMLDivElement | null>(null)\n\n  const {getField} = useSchema()\n  const {getDocument} = useDocuments()\n\n  const {field, parent} = getField(node)\n\n  const title = useMemo(() => {\n    return field?.title || field?.name || 'Unknown type'\n  }, [field])\n\n  const [items, setItems] = useState<ContextMenuNode[] | undefined>(undefined)\n\n  useEffect(() => {\n    const fetchContextMenuItems = async () => {\n      const doc = getDocument(node.id)\n      if (!doc) return\n      const items = await getContextMenuItems({node, field, parent, doc})\n      setItems(items)\n    }\n    fetchContextMenuItems()\n  }, [field, node, parent, getDocument])\n\n  const contextMenuReferenceElement = useMemo(() => {\n    return {\n      getBoundingClientRect: () => ({\n        bottom: y,\n        left: x,\n        right: x,\n        top: y,\n        width: 0,\n        height: 0,\n      }),\n    } as HTMLElement\n  }, [x, y])\n\n  const icon = useMemo(() => {\n    return getNodeIcon(field)\n  }, [field])\n\n  return (\n    <PopoverPortal setBoundaryElement={setBoundaryElement} onDismiss={onDismiss}>\n      <Popover\n        __unstable_margins={POPOVER_MARGINS}\n        arrow={false}\n        open\n        placement=\"right-start\"\n        referenceElement={contextMenuReferenceElement}\n        content={\n          <Menu style={{minWidth: 120, maxWidth: 160}}>\n            <Flex gap={2} padding={2}>\n              <Box flex=\"none\">{items ? <Text size={1}>{icon}</Text> : <Spinner size={1} />}</Box>\n\n              <Stack flex={1} space={2}>\n                <Text size={1} weight=\"semibold\">\n                  {items ? title : 'Loading...'}\n                </Text>\n              </Stack>\n            </Flex>\n\n            {items && (\n              <>\n                <MenuDivider />\n                {items.map((item, i) => (\n                  <ContextMenuItem\n                    key={i}\n                    node={item}\n                    onDismiss={onDismiss}\n                    boundaryElement={boundaryElement}\n                  />\n                ))}\n              </>\n            )}\n          </Menu>\n        }\n      >\n        <div\n          key={`${x}-${y}`}\n          style={{\n            position: 'absolute',\n            left: x,\n            top: y,\n          }}\n        />\n      </Popover>\n    </PopoverPortal>\n  )\n}\n","export function getLinkHref(href: string, referer: string): string {\n  try {\n    const parsed = new URL(href, typeof location === 'undefined' ? undefined : location.origin)\n    if (parsed.hash) {\n      const hash = new URL(getLinkHref(parsed.hash.slice(1), referer))\n      return `${parsed.origin}${parsed.pathname}${parsed.search}#${hash.pathname}${hash.search}`\n    }\n    parsed.searchParams.set('preview', referer)\n    return parsed.toString()\n  } catch {\n    return href\n  }\n}\n","import type {PreviewSnapshot} from '@sanity/presentation-comlink'\nimport {createContext} from 'react'\n\nexport type PreviewSnapshotsContextValue = PreviewSnapshot[]\n\nexport const PreviewSnapshotsContext = createContext<PreviewSnapshotsContextValue | null>(null)\n","import {useContext} from 'react'\nimport {PreviewSnapshotsContext, type PreviewSnapshotsContextValue} from './PreviewSnapshotsContext'\n\nexport function usePreviewSnapshots(): PreviewSnapshotsContextValue {\n  const context = useContext(PreviewSnapshotsContext)\n\n  if (!context) {\n    throw new Error('Preview Snapshots context is missing')\n  }\n\n  return context\n}\n","import {createEditUrl, studioPath} from '@sanity/client/csm'\nimport {DocumentIcon, DragHandleIcon, EllipsisVerticalIcon, PlugIcon} from '@sanity/icons'\nimport {MenuButton, MenuDivider} from '@sanity/ui'\nimport {Box, Button, Card, Flex, Menu, MenuItem, Stack, Text} from '@sanity/ui/_visual-editing'\nimport {pathToUrlString} from '@sanity/visual-editing-csm'\nimport {\n  Fragment,\n  isValidElement,\n  memo,\n  startTransition,\n  useCallback,\n  useEffect,\n  useId,\n  useMemo,\n  useRef,\n  useState,\n  useSyncExternalStore,\n  type CSSProperties,\n  type FunctionComponent,\n  type MouseEventHandler,\n  type ReactElement,\n} from 'react'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport {styled} from 'styled-components'\nimport {v4 as uuid} from 'uuid'\nimport {PointerEvents} from '../overlay-components/components/PointerEvents'\nimport type {\n  ElementChildTarget,\n  ElementFocusedState,\n  ElementNode,\n  OverlayComponent,\n  OverlayComponentResolver,\n  OverlayComponentResolverContext,\n  OverlayPluginDefinition,\n  OverlayPluginExclusiveDefinition,\n  OverlayPluginHudDefinition,\n  OverlayRect,\n  SanityNode,\n  SanityStegaNode,\n  VisualEditingNode,\n} from '../types'\nimport {getLinkHref} from '../util/getLinkHref'\nimport {PopoverBackground} from './PopoverPortal'\nimport {usePreviewSnapshots} from './preview/usePreviewSnapshots'\nimport {useSchema} from './schema/useSchema'\n\nconst isReactElementOverlayComponent = (\n  component:\n    | OverlayComponent\n    | {component: OverlayComponent; props?: Record<string, unknown>}\n    | Array<OverlayComponent | {component: OverlayComponent; props?: Record<string, unknown>}>\n    | ReactElement,\n): component is React.JSX.Element => {\n  return isValidElement(component)\n}\n\nexport interface ElementOverlayProps {\n  inFrame: boolean\n  id: string\n  comlink?: VisualEditingNode\n  componentResolver?: OverlayComponentResolver\n  plugins?: OverlayPluginDefinition[]\n  draggable: boolean\n  element: ElementNode\n  focused: ElementFocusedState\n  hovered: boolean\n  isDragging: boolean\n  node: SanityNode | SanityStegaNode\n  rect: OverlayRect\n  showActions: boolean\n  wasMaybeCollapsed: boolean\n  enableScrollIntoView: boolean\n  targets: ElementChildTarget[]\n  elementType: 'element' | 'group'\n  onActivateExclusivePlugin?: (\n    plugin: OverlayPluginExclusiveDefinition,\n    context: OverlayComponentResolverContext,\n  ) => void\n  onMenuOpenChange: (open: boolean) => void\n}\n\nconst Root = styled(Card)`\n  background-color: var(--overlay-bg);\n  border-radius: 3px;\n  pointer-events: none;\n  position: absolute;\n  will-change: transform;\n  box-shadow: var(--overlay-box-shadow);\n  transition: none;\n\n  --overlay-bg: transparent;\n  --overlay-box-shadow: inset 0 0 0 1px transparent;\n\n  [data-overlays] & {\n    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));\n    --overlay-box-shadow: inset 0 0 0 2px\n      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));\n  }\n\n  [data-fading-out] & {\n    transition:\n      box-shadow 1550ms,\n      background-color 1550ms;\n\n    --overlay-bg: rgba(0, 0, 255, 0);\n    --overlay-box-shadow: inset 0 0 0 1px transparent;\n  }\n\n  &[data-focused] {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  }\n\n  &[data-hovered]:not([data-focused]) {\n    transition: none;\n    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);\n  }\n\n  /* [data-unmounted] & {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  } */\n\n  :link {\n    text-decoration: none;\n  }\n`\n\nconst Actions = styled(Flex)`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`\n\nconst HUD = styled(Flex)`\n  top: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  gap: 4px;\n  padding: 4px 0;\n  flex-wrap: wrap;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    top: calc(100% + 2rem);\n  }\n`\n\nconst MenuWrapper = styled(Flex)`\n  margin: -0.5rem;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n`\n\nconst Tab = styled(Flex)`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  [data-hovered]:not([data-menu-open]) & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`\n\nconst ActionOpen = styled(Card)`\n  cursor: pointer;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n\n  & [data-ui='Text'] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`\n\nconst Labels = styled(Flex)`\n  display: flex;\n  align-items: center;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n  & [data-ui='Text'],\n  & [data-sanity-icon] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`\n\nconst ExclusivePluginContainer = styled.div`\n  position: absolute;\n  inset: 0;\n  pointer-events: all;\n`\n\nfunction createIntentLink(node: SanityNode) {\n  const {id, type, path, baseUrl, tool, workspace, perspective} = node\n\n  const [url, search] = createEditUrl({\n    baseUrl,\n    workspace,\n    tool,\n    type: type!,\n    id,\n    path: path ? pathToUrlString(studioPath.fromString(path)) : [],\n  }).split('?')\n  const searchParams = new URLSearchParams(search)\n  const resolvedPerspective = perspective || searchParams.get('perspective')\n  if (resolvedPerspective === 'drafts') {\n    // 'drafts' is not a valid search param in the studio URL, having no `perspective` is the same as 'drafts'\n    searchParams.delete('perspective')\n  } else if (resolvedPerspective) {\n    searchParams.set('perspective', resolvedPerspective)\n  }\n  return `${url}?${searchParams}`\n}\n\nconst ElementOverlayInner: FunctionComponent<ElementOverlayProps> = (props) => {\n  const {\n    id,\n    element,\n    focused,\n    componentResolver,\n    node,\n    showActions,\n    draggable,\n    targets,\n    elementType,\n    comlink,\n    onActivateExclusivePlugin,\n    onMenuOpenChange,\n    inFrame,\n  } = props\n\n  const {getField, getType} = useSchema()\n  const schemaType = getType(node)\n\n  const href = 'path' in node ? createIntentLink(node) : node.href\n\n  const previewSnapshots = usePreviewSnapshots()\n\n  const title = useMemo(() => {\n    if (!('path' in node)) return undefined\n    return previewSnapshots.find((snapshot) => snapshot._id === node.id)?.title\n  }, [node, previewSnapshots])\n\n  const resolverContexts = useMemo<{\n    legacyComponentContext: OverlayComponentResolverContext | undefined\n    pluginContexts: OverlayComponentResolverContext[]\n  }>(() => {\n    function getContext(\n      node: SanityNode | SanityStegaNode,\n      nodeElement?: ElementNode,\n    ): OverlayComponentResolverContext | undefined {\n      const schemaType = getType(node)\n      const {field, parent} = getField(node)\n      if (!('id' in node)) return undefined\n      if (!field || !schemaType) return undefined\n      const type = field.value.type\n      return {\n        document: schemaType,\n        element,\n        targetElement: nodeElement || element,\n        field,\n        focused: !!focused,\n        node,\n        parent,\n        type,\n      }\n    }\n    return {\n      legacyComponentContext: elementType === 'element' ? getContext(node) : undefined,\n      pluginContexts: targets\n        .map((target) => getContext(target.sanity, target.element))\n        .filter((ctx) => ctx !== undefined),\n    }\n  }, [elementType, node, targets, getType, getField, element, focused])\n\n  const customComponents = useCustomComponents(\n    resolverContexts.legacyComponentContext,\n    componentResolver,\n  )\n\n  const nodePluginCollections = useResolvedNodePlugins(\n    resolverContexts.pluginContexts,\n    props.plugins,\n  )\n\n  const icon = schemaType?.icon ? (\n    <div dangerouslySetInnerHTML={{__html: schemaType.icon}} />\n  ) : (\n    <DocumentIcon />\n  )\n\n  const menuId = useId()\n\n  const hasMenuitems = nodePluginCollections?.some(\n    (nodePluginCollection) => nodePluginCollection.exclusive.length > 0,\n  )\n  const showMenu = hasMenuitems || nodePluginCollections?.length > 1\n\n  const handleLabelClick = useCallback(() => {\n    window.dispatchEvent(new CustomEvent('sanity-overlay/label-click', {detail: {id}}))\n  }, [id])\n\n  return (\n    <>\n      <PointerEvents>\n        {showActions ? (\n          <Actions gap={1} paddingY={1}>\n            <Link inFrame={inFrame} href={href} />\n          </Actions>\n        ) : null}\n        {(title || showMenu) && (\n          <Tab gap={1} paddingY={1} onClick={handleLabelClick}>\n            <Labels gap={2} padding={2}>\n              {draggable && (\n                <Box marginRight={1}>\n                  <Text className=\"drag-handle\" size={0}>\n                    <DragHandleIcon />\n                  </Text>\n                </Box>\n              )}\n              <Text size={0}>{icon}</Text>\n\n              {title && (\n                <Text size={1} weight=\"medium\">\n                  {title}\n                </Text>\n              )}\n\n              {showMenu && (\n                <Box\n                  paddingLeft={2}\n                  onClick={(e) => {\n                    // Do not propagate and click the label too if clicking menu button\n                    e.stopPropagation()\n                  }}\n                >\n                  <MenuWrapper>\n                    <MenuButton\n                      id={menuId}\n                      popover={{\n                        animate: true,\n                        placement: 'bottom-start',\n                        constrainSize: true,\n                        tone: 'default',\n                      }}\n                      onOpen={() => {\n                        onMenuOpenChange?.(true)\n                      }}\n                      onClose={() => {\n                        onMenuOpenChange?.(false)\n                      }}\n                      button={<Button icon={EllipsisVerticalIcon} tone=\"primary\" padding={2} />}\n                      menu={\n                        <Menu paddingY={0}>\n                          <PointerEvents>\n                            {nodePluginCollections?.map((nodePluginCollection, index) => (\n                              <Fragment key={nodePluginCollection.id}>\n                                <Stack role=\"group\" paddingY={1} space={0}>\n                                  <MenuItem\n                                    paddingY={2}\n                                    text={\n                                      <Box paddingY={2}>\n                                        <Text muted size={1} style={{textTransform: 'capitalize'}}>\n                                          {`${nodePluginCollection.context.document.name}: ${nodePluginCollection.context.field?.name}`}\n                                        </Text>\n                                      </Box>\n                                    }\n                                    onClick={() => {\n                                      if (nodePluginCollection.context.node) {\n                                        comlink?.post(\n                                          'visual-editing/focus',\n                                          nodePluginCollection.context.node,\n                                        )\n                                      }\n                                    }}\n                                  />\n                                  {nodePluginCollection.exclusive.map((exclusive) => {\n                                    const Component = exclusive.component\n                                    if (!Component) return null\n                                    return (\n                                      <MenuItem\n                                        paddingY={2}\n                                        key={exclusive.name}\n                                        icon={exclusive.icon || <PlugIcon />}\n                                        text={\n                                          <Box paddingY={2}>\n                                            <Text size={1}>\n                                              {exclusive.title || exclusive.name}\n                                            </Text>\n                                          </Box>\n                                        }\n                                        onClick={() =>\n                                          onActivateExclusivePlugin?.(\n                                            exclusive,\n                                            nodePluginCollection.context,\n                                          )\n                                        }\n                                      />\n                                    )\n                                  })}\n                                </Stack>\n                                {index < nodePluginCollections.length - 1 && <MenuDivider />}\n                              </Fragment>\n                            ))}\n                          </PointerEvents>\n                        </Menu>\n                      }\n                    />\n                  </MenuWrapper>\n                </Box>\n              )}\n            </Labels>\n          </Tab>\n        )}\n\n        <HUD>\n          {nodePluginCollections?.map((nodePluginCollection) => (\n            <Fragment key={nodePluginCollection.id}>\n              {nodePluginCollection.hud.map((hud) => {\n                const Component = hud.component\n                if (!Component) return null\n                return <Component key={hud.name} {...nodePluginCollection.context} />\n              })}\n            </Fragment>\n          ))}\n        </HUD>\n      </PointerEvents>\n\n      {Array.isArray(customComponents)\n        ? customComponents.map(({component: Component, props}, i) => {\n            return (\n              <Component\n                key={i}\n                PointerEvents={PointerEvents}\n                {...resolverContexts.legacyComponentContext!}\n                {...props}\n              />\n            )\n          })\n        : customComponents}\n    </>\n  )\n}\n\nexport const ElementOverlay = memo(function ElementOverlay(\n  props: Omit<ElementOverlayProps, 'setActiveExclusivePlugin' | 'onMenuOpenChange'>,\n) {\n  const {draggable, focused, hovered, rect, wasMaybeCollapsed, enableScrollIntoView, inFrame} =\n    props\n\n  const ref = useRef<HTMLDivElement>(null)\n\n  const scrolledIntoViewRef = useRef(false)\n\n  const style = useMemo<CSSProperties>(\n    () => ({\n      width: `${rect.w}px`,\n      height: `${rect.h}px`,\n      transform: `translate(${rect.x}px, ${rect.y}px)`,\n    }),\n    [rect],\n  )\n\n  useEffect(() => {\n    if (\n      !scrolledIntoViewRef.current &&\n      !wasMaybeCollapsed &&\n      focused === true &&\n      ref.current &&\n      enableScrollIntoView\n    ) {\n      const target = ref.current\n      scrollIntoView(ref.current, {\n        // Workaround issue with scroll-into-view-if-needed struggling with iframes\n        behavior: (actions) => {\n          if (actions.length === 0) {\n            // An empty actions list equals scrolling isn't needed\n            return\n          }\n          // Uses native scrollIntoView to ensure iframes behave correctly\n          target.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'nearest',\n          })\n        },\n        scrollMode: 'if-needed',\n        block: 'center',\n        inline: 'nearest',\n      })\n    }\n\n    scrolledIntoViewRef.current = focused === true\n  }, [focused, wasMaybeCollapsed, enableScrollIntoView])\n\n  const [isNearTop, setIsNearTop] = useState(false)\n  useEffect(() => {\n    if (!ref.current || !hovered) return undefined\n\n    const io = new IntersectionObserver(\n      ([intersection]) => {\n        setIsNearTop(intersection.boundingClientRect.top < 0)\n      },\n      {threshold: 1},\n    )\n    io.observe(ref.current)\n    return () => io.disconnect()\n  }, [hovered, isNearTop])\n\n  const [activeExclusivePlugin, setActiveExclusivePlugin] = useState<{\n    plugin: OverlayPluginExclusiveDefinition\n    context: OverlayComponentResolverContext\n  } | null>(null)\n\n  const closeExclusivePluginView = useCallback(() => {\n    setActiveExclusivePlugin(null)\n    window.dispatchEvent(new CustomEvent('sanity-overlay/exclusive-plugin-closed'))\n  }, [])\n\n  const onActivateExclusivePlugin = useCallback(\n    (plugin: OverlayPluginExclusiveDefinition, context: OverlayComponentResolverContext) => {\n      setActiveExclusivePlugin({plugin, context})\n    },\n    [],\n  )\n\n  const handleExclusivePluginClick: MouseEventHandler<HTMLDivElement> = (event) => {\n    event.stopPropagation()\n  }\n\n  const ExclusivePluginComponent = activeExclusivePlugin?.plugin.component\n\n  const [menuOpen, setMenuOpen] = useState(false)\n\n  useEffect(() => {\n    startTransition(() => setMenuOpen(false))\n  }, [hovered])\n\n  return (\n    <>\n      {menuOpen || ExclusivePluginComponent ? (\n        <PopoverBackground onDismiss={closeExclusivePluginView} blockScroll={menuOpen} />\n      ) : null}\n      <Root\n        data-focused={focused ? '' : undefined}\n        data-hovered={hovered ? '' : undefined}\n        data-flipped={isNearTop ? '' : undefined}\n        data-draggable={draggable ? '' : undefined}\n        data-menu-open={menuOpen ? '' : undefined}\n        ref={ref}\n        style={style}\n      >\n        {ExclusivePluginComponent ? (\n          <ExclusivePluginContainer\n            data-sanity-overlay-element\n            onClick={handleExclusivePluginClick}\n          >\n            <ExclusivePluginComponent\n              {...activeExclusivePlugin.context}\n              closeExclusiveView={closeExclusivePluginView}\n            />\n          </ExclusivePluginContainer>\n        ) : hovered ? (\n          <ElementOverlayInner\n            {...props}\n            inFrame={inFrame}\n            onActivateExclusivePlugin={onActivateExclusivePlugin}\n            onMenuOpenChange={setMenuOpen}\n          />\n        ) : null}\n      </Root>\n    </>\n  )\n})\n\ninterface NodePluginCollection {\n  id: string\n  context: OverlayComponentResolverContext\n  hud: OverlayPluginHudDefinition[]\n  exclusive: OverlayPluginExclusiveDefinition[]\n}\n\nfunction useResolvedNodePlugins(\n  componentContexts: OverlayComponentResolverContext[],\n  plugins?: OverlayPluginDefinition[],\n) {\n  return useMemo(\n    () =>\n      componentContexts.map((componentContext) => {\n        const instance: NodePluginCollection = {\n          id: uuid(),\n          context: componentContext,\n          hud: [],\n          exclusive: [],\n        }\n\n        plugins?.forEach((plugin) => {\n          if (!plugin.guard?.(componentContext)) return\n          if (plugin.type === 'hud') instance.hud.push(plugin)\n          if (plugin.type === 'exclusive') instance.exclusive.push(plugin)\n        })\n\n        return instance\n      }),\n    [componentContexts, plugins],\n  )\n}\n\nfunction useCustomComponents(\n  componentContext: OverlayComponentResolverContext | undefined,\n  componentResolver: OverlayComponentResolver | undefined,\n) {\n  return useMemo(() => {\n    if (!componentContext) return undefined\n    const resolved = componentResolver?.(componentContext)\n    if (!resolved) return undefined\n\n    if (isReactElementOverlayComponent(resolved)) {\n      return resolved\n    }\n\n    return (Array.isArray(resolved) ? resolved : [resolved]).map((component) => {\n      if (typeof component === 'object' && 'component' in component) {\n        return component\n      }\n      return {component, props: {}}\n    })\n  }, [componentResolver, componentContext])\n}\n\nconst Link = memo(function Link(props: {href: string; inFrame: boolean}) {\n  const {inFrame} = props\n  const referer = useSyncExternalStore(\n    useCallback((onStoreChange) => {\n      const handlePopState = () => onStoreChange()\n      window.addEventListener('popstate', handlePopState)\n      return () => window.removeEventListener('popstate', handlePopState)\n    }, []),\n    () => window.location.href,\n  )\n  const href = useMemo(() => getLinkHref(props.href, referer), [props.href, referer])\n\n  return (\n    <Box\n      as=\"a\"\n      href={href}\n      target={inFrame ? undefined : '_blank'}\n      rel={inFrame ? 'noopener' : 'noopener noreferrer'}\n    >\n      <ActionOpen padding={2}>\n        <Text size={1} weight=\"medium\">\n          Open in Studio\n        </Text>\n      </ActionOpen>\n    </Box>\n  )\n})\n","import type {FunctionComponent} from 'react'\nimport type {OverlayRect} from '../types'\n\nexport const OverlayDragGroupRect: FunctionComponent<{\n  dragGroupRect: OverlayRect\n}> = ({dragGroupRect}) => {\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        top: `${dragGroupRect.y}px`,\n        left: `${dragGroupRect.x}px`,\n        width: `${dragGroupRect.w - 1}px`,\n        height: `${dragGroupRect.h - 1}px`,\n        border: '1px dashed #f0709b',\n        pointerEvents: 'none',\n      }}\n    ></div>\n  )\n}\n","import type {FunctionComponent} from 'react'\nimport type {DragInsertPosition} from '../types'\n\nconst markerThickness = 6\n\nfunction lerp(v0: number, v1: number, t: number) {\n  return v0 * (1 - t) + v1 * t\n}\n\nexport const OverlayDragInsertMarker: FunctionComponent<{\n  dragInsertPosition: DragInsertPosition\n}> = ({dragInsertPosition}) => {\n  if (dragInsertPosition === null) return\n\n  const flow = dragInsertPosition?.left || dragInsertPosition?.right ? 'horizontal' : 'vertical'\n\n  let x = 0\n  let y = 0\n  let width = 0\n  let height = 0\n  const offsetMultiplier = 0.0125\n\n  if (flow === 'horizontal') {\n    const {left, right} = dragInsertPosition\n\n    width = markerThickness\n\n    if (right && left) {\n      const startX = left.rect.x + left.rect.w\n      const endX = right.rect.x\n      const targetHeight = Math.min(right.rect.h, left.rect.h)\n      const offset = targetHeight * offsetMultiplier\n\n      x = lerp(startX, endX, 0.5) - markerThickness / 2\n      y = left.rect.y + offset\n\n      height = Math.min(right.rect.h, left.rect.h) - offset * 2\n    } else if (right && !left) {\n      const targetHeight = right.rect.h\n      const offset = targetHeight * offsetMultiplier\n\n      x = right.rect.x - markerThickness / 2\n      y = right.rect.y + offset\n      height = right.rect.h - offset * 2\n    } else if (left && !right) {\n      const targetHeight = left.rect.h\n      const offset = targetHeight * offsetMultiplier\n\n      x = left.rect.x + left.rect.w - markerThickness / 2\n      y = left.rect.y + offset\n      height = left.rect.h - offset * 2\n    }\n  } else {\n    const {bottom, top} = dragInsertPosition\n\n    if (bottom && top) {\n      const startX = Math.min(top.rect.x, bottom.rect.x)\n      const startY = top.rect.y + top.rect.h\n      const endY = bottom.rect.y\n      const targetWidth = Math.min(bottom.rect.w, top.rect.w)\n      const offset = targetWidth * offsetMultiplier\n\n      height = markerThickness\n\n      x = startX + offset\n      y = lerp(startY, endY, 0.5) - markerThickness / 2\n      width = Math.max(bottom.rect.w, top.rect.w) - offset * 2\n    } else if (bottom && !top) {\n      const targetWidth = bottom.rect.w\n      const offset = targetWidth * offsetMultiplier\n\n      x = bottom.rect.x + offset\n      y = bottom.rect.y - markerThickness / 2\n      width = bottom.rect.w - offset * 2\n      height = markerThickness\n    } else if (top && !bottom) {\n      const targetWidth = top.rect.w\n      const offset = targetWidth * offsetMultiplier\n\n      x = top.rect.x + offset\n      y = top.rect.y + top.rect.h - markerThickness / 2\n      width = top.rect.w - offset * 2\n      height = markerThickness\n    }\n  }\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        width: `${width}px`,\n        height: `${height}px`,\n        transform: `translate(${x}px, ${y}px)`,\n        background: '#556bfc',\n        border: '2px solid white',\n        borderRadius: '999px',\n        zIndex: '999999',\n      }}\n    ></div>\n  )\n}\n","import {Card, usePrefersDark, useTheme_v2} from '@sanity/ui/_visual-editing'\nimport type {FunctionComponent} from 'react'\nimport {styled} from 'styled-components'\nimport type {DragSkeleton} from '../types'\n\nconst Root = styled.div<{\n  $width: number\n  $height: number\n  $offsetX: number\n  $offsetY: number\n  $scaleFactor: number\n}>`\n  --drag-preview-opacity: 0.98;\n  --drag-preview-skeleton-stroke: #ffffff;\n\n  @media (prefers-color-scheme: dark) {\n    --drag-preview-skeleton-stroke: #383d51;\n  }\n\n  position: fixed;\n  display: grid;\n  transform: ${({$scaleFactor, $width, $height}) =>\n    `translate(calc(var(--drag-preview-x) - ${$width / 2}px), calc(var(--drag-preview-y) - ${$height / 2}px)) scale(${$scaleFactor})`};\n  width: ${({$width}) => `${$width}px`};\n  height: ${({$height}) => `${$height}px`};\n  z-index: 9999999;\n  opacity: var(--drag-preview-opacity);\n  cursor: move;\n\n  .drag-preview-content-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    container-type: inline-size;\n  }\n\n  [data-ui='card'] {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n\n  .drag-preview-skeleton {\n    position: absolute;\n    inset: 0;\n\n    rect {\n      stroke: var(--drag-preview-skeleton-stroke);\n    }\n  }\n\n  .drag-preview-handle {\n    position: absolute;\n    top: 4cqmin;\n    left: 4cqmin;\n    width: 6cqmin;\n    fill: var(--drag-preview-handle-fill);\n  }\n`\n\nfunction clamp(number: number, min: number, max: number): number {\n  return number < min ? min : number > max ? max : number\n}\n\nfunction map(number: number, inMin: number, inMax: number, outMin: number, outMax: number): number {\n  const mapped: number = ((number - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin\n  return clamp(mapped, outMin, outMax)\n}\n\nexport const OverlayDragPreview: FunctionComponent<{skeleton: DragSkeleton}> = ({skeleton}) => {\n  const maxSkeletonWidth = Math.min(skeleton.maxWidth, window.innerWidth / 2)\n  const scaleFactor = skeleton.w > maxSkeletonWidth ? maxSkeletonWidth / skeleton.w : 1\n\n  const offsetX = skeleton.offsetX * scaleFactor\n  const offsetY = skeleton.offsetY * scaleFactor\n\n  const prefersDark = usePrefersDark()\n  const theme = useTheme_v2()\n\n  const radius = theme.radius[~~map(skeleton.w, 0, 1920, 1, theme.radius.length - 2)]\n\n  const imageRects = skeleton.childRects.filter((r) => r.tagName === 'IMG')\n  const textRects = skeleton.childRects.filter((r) => r.tagName !== 'IMG')\n\n  return (\n    <Root\n      $width={skeleton.w}\n      $height={skeleton.h}\n      $offsetX={offsetX}\n      $offsetY={offsetY}\n      $scaleFactor={scaleFactor}\n    >\n      <Card\n        radius={radius}\n        shadow={4}\n        overflow=\"hidden\"\n        tone=\"transparent\"\n        scheme={prefersDark ? 'dark' : 'light'}\n      >\n        <div className=\"drag-preview-content-wrapper\">\n          <svg className=\"drag-preview-skeleton\" viewBox={`0 0 ${skeleton.w} ${skeleton.h}`}>\n            {/* render image rects first to account for background images overlapping text */}\n            {[...imageRects, ...textRects].map((r, i) => (\n              <rect\n                key={i}\n                x={r.x}\n                y={r.y}\n                width={r.w}\n                height={r.h}\n                fill={theme.color.skeleton.from}\n              ></rect>\n            ))}\n          </svg>\n        </div>\n      </Card>\n    </Root>\n  )\n}\n","import {ExpandIcon} from '@sanity/icons'\nimport {Card, Flex, Hotkeys, Text} from '@sanity/ui/_visual-editing'\nimport type {FunctionComponent} from 'react'\nimport {styled} from 'styled-components'\n\nconst Root = styled(Card)`\n  position: fixed;\n  bottom: 2rem;\n  left: 2rem;\n`\n\nexport const OverlayMinimapPrompt: FunctionComponent = () => {\n  return (\n    <Root padding={2} shadow={2} radius={2} style={{zIndex: '999999'}}>\n      <Flex align=\"center\" gap={2}>\n        <Hotkeys keys={['Shift']} />\n        <Text size={1}>Zoom Out</Text>\n        <ExpandIcon />\n      </Flex>\n    </Root>\n  )\n}\n","import type {VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport type {ElementState, OverlayMsg} from '../types'\n\n/**\n * Reducer for managing element state from received channel messages\n * @internal\n */\nexport const elementsReducer = (\n  elements: ElementState[],\n  message: OverlayMsg | VisualEditingControllerMsg,\n): ElementState[] => {\n  const {type} = message\n  switch (type) {\n    case 'element/register': {\n      const elementExists = !!elements.find((e) => e.id === message.id)\n      if (elementExists) return elements\n\n      return [\n        ...elements,\n        {\n          id: message.id,\n          activated: false,\n          element: message.element,\n          focused: false,\n          hovered: false,\n          rect: message.rect,\n          sanity: message.sanity,\n          dragDisabled: message.dragDisabled,\n          targets: message.targets,\n          elementType: message.elementType,\n        },\n      ]\n    }\n    case 'element/activate':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, activated: true}\n        }\n        return e\n      })\n    case 'element/update': {\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {\n            ...e,\n            sanity: message.sanity,\n            rect: message.rect,\n            targets: message.targets,\n            elementType: message.elementType,\n          }\n        }\n        return e\n      })\n    }\n    case 'element/unregister':\n      return elements.filter((e) => e.id !== message.id)\n    case 'element/deactivate':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, activated: false, hovered: false}\n        }\n        return e\n      })\n    case 'element/mouseenter':\n      return elements.map((e) => {\n        if (e.id === message.id) {\n          return {...e, rect: message.rect, hovered: true}\n        }\n        return {...e, hovered: false}\n      })\n    case 'element/mouseleave':\n      return elements.map((element) => {\n        if (element.id === message.id) {\n          return {...element, hovered: false}\n        }\n        return element\n      })\n    case 'element/updateRect':\n      return elements.map((element) => {\n        if (element.id === message.id) {\n          return {...element, rect: message.rect}\n        }\n        return element\n      })\n    case 'element/click':\n      return elements.map((e) => {\n        return {...e, focused: e.id === message.id && 'clicked'}\n      })\n    case 'overlay/reset-mouse-state':\n      return elements.map((e) => {\n        return {...e, focused: false, hovered: false}\n      })\n    case 'overlay/blur':\n      return elements.map((e) => {\n        return {...e, focused: false}\n      })\n    case 'presentation/blur':\n      return elements.map((e) => {\n        return {...e, focused: false}\n      })\n    case 'presentation/focus': {\n      // Before setting the focus state of each element, check to see if any\n      // element has gained focus from an `element/click` message. Presentation\n      // tool \"reflects\" these back as a `presentation/focus` message.\n      const clickedElement = elements.find((e) => e.focused === 'clicked')\n      return elements.map((e) => {\n        // We want to focus any element which matches the received id and path\n        const focused =\n          'path' in e.sanity &&\n          e.sanity.id === message.data.id &&\n          e.sanity.path === message.data.path\n\n        // If we have a 'clicked' element, and that element matches, it is a\n        // reflection, so we maintain the focus state\n        if (clickedElement && e === clickedElement && focused) {\n          return e\n        }\n\n        return {\n          ...e,\n          // Mark as a dupe if another matching item has been clicked to prevent\n          // scrolling, otherwise just set focus as a boolean\n          focused: focused && clickedElement ? 'duplicate' : focused,\n        }\n      })\n    }\n    default:\n      return elements\n  }\n}\n","import type {ClientPerspective} from '@sanity/client'\nimport type {SanityNode, VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport type {\n  DragInsertPosition,\n  DragSkeleton,\n  ElementState,\n  OverlayMsg,\n  OverlayRect,\n} from '../types'\nimport {elementsReducer} from './elementsReducer'\n\nexport interface OverlayState {\n  contextMenu: {\n    node: SanityNode\n    position: {\n      x: number\n      y: number\n    }\n  } | null\n  focusPath: string\n  elements: ElementState[]\n  wasMaybeCollapsed: boolean\n  perspective: ClientPerspective\n  isDragging: boolean\n  dragInsertPosition: DragInsertPosition\n  dragSkeleton: DragSkeleton | null\n  dragShowMinimap: boolean\n  dragShowMinimapPrompt: boolean\n  dragMinimapTransition: boolean\n  dragGroupRect: OverlayRect | null\n}\n\nexport function overlayStateReducer(\n  state: OverlayState,\n  message: OverlayMsg | VisualEditingControllerMsg,\n): OverlayState {\n  const {type} = message\n  let {\n    contextMenu,\n    focusPath,\n    perspective,\n    isDragging,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    dragMinimapTransition,\n    dragGroupRect,\n  } = state\n  let wasMaybeCollapsed = false\n\n  if (type === 'presentation/focus') {\n    const prevFocusPath = state.focusPath\n\n    focusPath = message.data.path\n\n    if (prevFocusPath !== focusPath) {\n      wasMaybeCollapsed = prevFocusPath.slice(focusPath.length).startsWith('[')\n    }\n  }\n\n  if (type === 'presentation/perspective') {\n    perspective = message.data.perspective\n  }\n\n  if (type === 'element/contextmenu') {\n    if ('sanity' in message) {\n      contextMenu = {node: message.sanity, position: message.position}\n    } else {\n      contextMenu = null\n    }\n  }\n\n  if (\n    type === 'element/click' ||\n    type === 'element/mouseleave' ||\n    type === 'overlay/blur' ||\n    type === 'presentation/blur' ||\n    type === 'presentation/focus'\n  ) {\n    contextMenu = null\n  }\n\n  if (type === 'overlay/dragUpdateInsertPosition') {\n    dragInsertPosition = message.insertPosition\n  }\n\n  if (type === 'overlay/dragStart') {\n    isDragging = true\n  }\n\n  if (message.type === 'overlay/dragUpdateSkeleton') {\n    dragSkeleton = message.skeleton\n  }\n\n  if (type === 'overlay/dragEnd') {\n    isDragging = false\n  }\n\n  if (message.type === 'overlay/dragToggleMinimapPrompt') {\n    dragShowMinimapPrompt = message.display\n  }\n\n  if (type === 'overlay/dragStartMinimapTransition') {\n    dragMinimapTransition = true\n  }\n\n  if (type === 'overlay/dragEndMinimapTransition') {\n    dragMinimapTransition = false\n  }\n\n  if (type === 'overlay/dragUpdateGroupRect') {\n    dragGroupRect = message.groupRect\n  }\n\n  if (type === 'overlay/dragToggleMinimap') {\n    dragShowMinimap = message.display\n  }\n\n  return {\n    ...state,\n    contextMenu,\n    elements: elementsReducer(state.elements, message),\n    dragInsertPosition,\n    dragSkeleton,\n    dragGroupRect,\n    isDragging,\n    focusPath,\n    perspective,\n    wasMaybeCollapsed,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragMinimapTransition,\n  }\n}\n","import {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  type FunctionComponent,\n  type PropsWithChildren,\n} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {PreviewSnapshotsContext, type PreviewSnapshotsContextValue} from './PreviewSnapshotsContext'\n\nexport const PreviewSnapshotsProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n  }>\n> = function (props) {\n  const {comlink, children} = props\n\n  const [previewSnapshots, setPreviewSnapshots] = useState<PreviewSnapshotsContextValue>([])\n\n  const fetchPreviewSnapshots = useCallback(\n    async (signal: AbortSignal) => {\n      if (!comlink) return\n      try {\n        const response = await comlink.fetch('visual-editing/preview-snapshots', undefined, {\n          signal,\n          suppressWarnings: true,\n        })\n        setPreviewSnapshots(response.snapshots)\n      } catch {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n    },\n    [comlink],\n  )\n  useEffect(() => {\n    if (!comlink) return\n\n    const previewSapshotsFetch = new AbortController()\n    const unsub = comlink.onStatus(() => {\n      fetchPreviewSnapshots(previewSapshotsFetch.signal)\n    }, 'connected')\n\n    return () => {\n      previewSapshotsFetch.abort()\n      unsub()\n    }\n  }, [comlink, fetchPreviewSnapshots])\n\n  useEffect(() => {\n    return comlink?.on('presentation/preview-snapshots', (data) => {\n      setPreviewSnapshots(data.snapshots)\n    })\n  }, [comlink])\n\n  const context = useMemo<PreviewSnapshotsContextValue>(() => previewSnapshots, [previewSnapshots])\n  return (\n    <PreviewSnapshotsContext.Provider value={context}>{children}</PreviewSnapshotsContext.Provider>\n  )\n}\n","import type {\n  DocumentSchema,\n  ResolvedSchemaTypeMap,\n  SanityNode,\n  SanityStegaNode,\n  SchemaType,\n  TypeSchema,\n  UnresolvedPath,\n} from '@sanity/presentation-comlink'\nimport {\n  useCallback,\n  useDeferredValue,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  type FunctionComponent,\n  type PropsWithChildren,\n} from 'react'\nimport type {\n  ElementState,\n  OverlayElementField,\n  OverlayElementParent,\n  VisualEditingNode,\n} from '../../types'\nimport {SchemaContext, type SchemaContextValue} from './SchemaContext'\n\nfunction isSanityNode(node: SanityNode | SanityStegaNode): node is SanityNode {\n  return 'path' in node\n}\n\nfunction isDocumentSchemaType(type: SchemaType): type is DocumentSchema {\n  return type.type === 'document'\n}\n\nfunction isTypeSchemaType(type: SchemaType): type is TypeSchema {\n  return type.type === 'type'\n}\n\nfunction popUnkeyedPathSegments(path: string): string {\n  return path\n    .split('.')\n    .toReversed()\n    .reduce((acc, part) => {\n      if (acc.length) return [part, ...acc]\n      if (part.includes('[_key==')) return [part]\n      return []\n    }, [] as string[])\n    .join('.')\n}\n\nfunction getPathsWithUnresolvedTypes(elements: ElementState[]): {id: string; path: string}[] {\n  return elements.reduce((acc, element) => {\n    const {sanity} = element\n    if (!('id' in sanity)) return acc\n    if (!sanity.path.includes('[_key==')) return acc\n    const path = popUnkeyedPathSegments(sanity.path)\n    if (!acc.find((item) => item.id === sanity.id && item.path === path)) {\n      acc.push({id: sanity.id, path})\n    }\n    return acc\n  }, [] as UnresolvedPath[])\n}\n\nexport const SchemaProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n    elements: ElementState[]\n  }>\n> = function (props) {\n  const {comlink, children, elements} = props\n\n  const [resolvedTypes, setResolvedTypes] = useState<ResolvedSchemaTypeMap>(new Map())\n\n  const [schema, setSchema] = useState<SchemaType[] | null>(null)\n\n  useEffect(() => {\n    if (!comlink) return\n\n    async function fetchSchema(signal: AbortSignal) {\n      if (!comlink) return\n      try {\n        const response = await comlink.fetch('visual-editing/schema', undefined, {\n          signal,\n          suppressWarnings: true,\n        })\n        setSchema(response.schema)\n      } catch {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n    }\n    const schemaFetch = new AbortController()\n    const unsub = comlink.onStatus(() => {\n      fetchSchema(schemaFetch.signal)\n    }, 'connected')\n\n    return () => {\n      schemaFetch.abort()\n      unsub()\n    }\n  }, [comlink])\n\n  const reportedPathsRef = useRef<UnresolvedPath[]>([])\n  const paths = getPathsWithUnresolvedTypes(useDeferredValue(elements))\n  const controllerRef = useRef<AbortController | null>(null)\n\n  useEffect(() => {\n    if (!paths.length || !comlink) return\n    // We report a list of paths that reference array items using a _key. We need\n    // to resolve the types of each of these items so we can map them to the\n    // correct schema types. One day CSM might include this data for us.\n    const reportPaths = async (paths: UnresolvedPath[], signal: AbortSignal) => {\n      const initialReportedPaths = reportedPathsRef.current\n      try {\n        reportedPathsRef.current = paths\n        const response = await comlink.fetch(\n          'visual-editing/schema-union-types',\n          {paths},\n          {signal, suppressWarnings: true},\n        )\n        if (signal.aborted) return\n        setResolvedTypes(response.types)\n        controllerRef.current = null\n      } catch {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      }\n      if (signal.aborted) {\n        reportedPathsRef.current = initialReportedPaths\n      }\n    }\n\n    if (\n      paths.some(\n        (p) => !reportedPathsRef.current.find(({id, path}) => id === p.id && path === p.path),\n      )\n    ) {\n      // Abort any previous requests\n      controllerRef.current?.abort()\n      controllerRef.current = new AbortController()\n      reportPaths(paths, controllerRef.current.signal)\n    }\n  }, [comlink, paths])\n\n  const getType = useCallback(\n    <T extends 'document' | 'type' = 'document'>(\n      node: SanityNode | SanityStegaNode | string,\n      _type?: T,\n    ): T extends 'document' ? DocumentSchema | undefined : TypeSchema | undefined => {\n      const type = _type || 'document'\n      if (\n        !schema ||\n        (typeof node !== 'string' && (!isSanityNode(node) || !Array.isArray(schema)))\n      ) {\n        return undefined\n      }\n      const name = typeof node === 'string' ? node : node.type\n      const filter = type === 'document' ? isDocumentSchemaType : isTypeSchemaType\n      return schema\n        .filter(filter)\n        .find((schemaType) => schemaType.name === name) as T extends 'document'\n        ? DocumentSchema | undefined\n        : TypeSchema | undefined\n    },\n    [schema],\n  )\n\n  const getField = useCallback(\n    (\n      node: SanityNode | SanityStegaNode,\n    ): {\n      field: OverlayElementField\n      parent: OverlayElementParent\n    } => {\n      if (!isSanityNode(node)) {\n        return {\n          field: undefined,\n          parent: undefined,\n        }\n      }\n\n      const schemaType = getType(node)\n\n      if (!schemaType) {\n        return {\n          field: undefined,\n          parent: undefined,\n        }\n      }\n      function fieldFromPath(\n        schemaType: OverlayElementParent,\n        path: string[],\n        parent: OverlayElementParent,\n        prevPath: string[] = [],\n      ): {\n        field: OverlayElementField\n        parent: OverlayElementParent\n      } {\n        if (!schemaType) {\n          return {field: undefined, parent: undefined}\n        }\n\n        const [next, ...rest] = path\n\n        if ('fields' in schemaType) {\n          const objectField = schemaType.fields[next]\n          if (!objectField && 'rest' in schemaType) {\n            return fieldFromPath(schemaType.rest, path, schemaType, prevPath)\n          }\n          if (!rest.length) {\n            return {field: objectField, parent}\n          }\n          if (!objectField) {\n            throw new Error(\n              `[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path].join('.')}\"`,\n            )\n          }\n          return fieldFromPath(objectField.value, rest, schemaType, [...prevPath, next])\n        } else if (schemaType.type === 'array') {\n          return fieldFromPath(schemaType.of, path, schemaType, prevPath)\n        } else if (schemaType.type === 'arrayItem') {\n          if (!rest.length) return {field: schemaType, parent}\n          return fieldFromPath(schemaType.value, rest, schemaType, [...prevPath, next])\n        } else if (schemaType.type === 'union') {\n          const name = next.startsWith('[_key==')\n            ? resolvedTypes\n                ?.get((node as SanityNode).id)\n                ?.get([prevPath.join('.'), next].filter(Boolean).join(''))\n            : next\n          return fieldFromPath(\n            schemaType.of.find((item) => (item.type === 'unionOption' ? item.name === name : item)),\n            rest,\n            schemaType,\n            [...prevPath, next],\n          )\n        } else if (schemaType.type === 'unionOption') {\n          if (!next) return {field: schemaType, parent}\n          return fieldFromPath(schemaType.value, path, schemaType, prevPath)\n        } else if (schemaType.type === 'inline') {\n          const type = getType(schemaType.name, 'type')\n          return fieldFromPath((type as TypeSchema).value, path, schemaType, prevPath)\n        }\n        throw new Error(\n          `[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path].join('.')}\"`,\n        )\n      }\n\n      const nodePath = node.path.split('.').flatMap((part) => {\n        if (part.includes('[')) {\n          return part.split(/(\\[.+\\])/, 2)\n        }\n        return [part]\n      })\n\n      try {\n        return fieldFromPath(schemaType, nodePath, undefined)\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        if (e instanceof Error) console.warn(e.message)\n        return {field: undefined, parent: undefined}\n      }\n    },\n    [getType, resolvedTypes],\n  )\n\n  const context = useMemo<SchemaContextValue>(() => ({getField, getType}), [getField, getType])\n\n  return <SchemaContext.Provider value={context}>{children}</SchemaContext.Provider>\n}\n","import type {SerializableObject} from '@sanity/presentation-comlink'\nimport {useEffect, useMemo, type FunctionComponent, type PropsWithChildren} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {SharedStateContext} from './SharedStateContext'\n\nconst createStore = (initialState: SerializableObject) => {\n  let state = initialState\n  const getState = () => state\n  const listeners = new Set<() => void>()\n  const setState = (fn: (state: SerializableObject) => SerializableObject) => {\n    state = fn(state)\n    listeners.forEach((l) => l())\n  }\n  const subscribe = (listener: () => void) => {\n    listeners.add(listener)\n    return () => listeners.delete(listener)\n  }\n  return {getState, setState, subscribe}\n}\n\nconst store = createStore({})\n\nexport const SharedStateProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink?: VisualEditingNode\n  }>\n> = (props) => {\n  const {comlink, children} = props\n\n  useEffect(() => {\n    return comlink?.on('presentation/shared-state', (data) => {\n      if ('value' in data) {\n        store.setState((prev) => ({...prev, [data.key]: data.value}))\n      } else {\n        store.setState((prev) => {\n          return Object.fromEntries(Object.entries(prev).filter(([key]) => key !== data.key))\n        })\n      }\n    })\n  }, [comlink])\n\n  useEffect(() => {\n    async function fetch() {\n      const value = await comlink?.fetch('visual-editing/shared-state', undefined, {\n        suppressWarnings: true,\n      })\n      if (value) {\n        store.setState(() => value.state)\n      }\n    }\n    fetch().catch((reason) => {\n      // eslint-disable-next-line no-console\n      console.debug(reason)\n      // eslint-disable-next-line no-console\n      console.warn(\n        '[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date',\n      )\n    })\n  }, [comlink])\n\n  const value = useMemo(() => ({comlink, store}), [comlink])\n\n  return <SharedStateContext.Provider value={value}>{children}</SharedStateContext.Provider>\n}\n","import {useCallback, type FunctionComponent, type PropsWithChildren} from 'react'\nimport type {VisualEditingNode} from '../../types'\nimport {events, TelemetryContext, type TelemetryContextValue} from './TelemetryContext'\n\nexport const TelemetryProvider: FunctionComponent<\n  PropsWithChildren<{comlink?: VisualEditingNode}>\n> = ({children, comlink}) => {\n  const log = useCallback<TelemetryContextValue>(\n    (name, data) => {\n      if (!comlink) return\n\n      const event = events[name]\n\n      if (!event) {\n        throw new Error(`Telemetry event: ${name} does not exist`)\n      } else {\n        comlink.post('visual-editing/telemetry-log', {event, data})\n      }\n    },\n    [comlink],\n  )\n\n  return <TelemetryContext.Provider value={log}>{children}</TelemetryContext.Provider>\n}\n","import {useEffect, useRef, type MutableRefObject} from 'react'\nimport {createOverlayController} from '../controller'\nimport {useOptimisticActorReady} from '../react/useOptimisticActor'\nimport type {OverlayController, OverlayEventHandler} from '../types'\n\n/**\n * Hook for using an overlay controller\n * @internal\n */\nexport function useController(\n  element: HTMLElement | null,\n  handler: OverlayEventHandler,\n  inFrame: boolean,\n  inPopUp: boolean,\n): MutableRefObject<OverlayController | undefined> {\n  const overlayController = useRef<OverlayController | undefined>(undefined)\n\n  const optimisticActorReady = useOptimisticActorReady()\n\n  useEffect(() => {\n    if (!element) return undefined\n\n    overlayController.current = createOverlayController({\n      handler,\n      overlayElement: element,\n      inFrame,\n      inPopUp,\n      optimisticActorReady,\n    })\n\n    return () => {\n      overlayController.current?.destroy()\n      overlayController.current = undefined\n    }\n  }, [element, handler, inFrame, inPopUp, optimisticActorReady])\n\n  return overlayController\n}\n","import type {VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport {useEffect} from 'react'\nimport type {OverlayMsg, VisualEditingNode} from '../types'\n\nexport function usePerspectiveSync(\n  comlink: VisualEditingNode | undefined,\n  dispatch: (value: OverlayMsg | VisualEditingControllerMsg) => void,\n): void {\n  useEffect(() => {\n    const controller = new AbortController()\n    comlink\n      ?.fetch('visual-editing/fetch-perspective', undefined, {\n        signal: controller.signal,\n        suppressWarnings: true,\n      })\n      .then((data) => {\n        dispatch({type: 'presentation/perspective', data})\n      })\n      .catch(() => {\n        // Fail silently as the app may be communicating with a version of\n        // Presentation that does not support this feature\n      })\n\n    const unsub = comlink?.on('presentation/perspective', (data) => {\n      dispatch({type: 'presentation/perspective', data})\n    })\n\n    return () => {\n      unsub?.()\n      controller.abort()\n    }\n  }, [comlink, dispatch])\n}\n","import type {ClientPerspective, ContentSourceMapDocuments} from '@sanity/client'\nimport {useCallback, useEffect, useRef} from 'react'\nimport type {ElementState, SanityNode, VisualEditingNode} from '../types'\n\nfunction isEqualSets(a: Set<string>, b: Set<string>) {\n  if (a === b) return true\n  if (a.size !== b.size) return false\n  for (const value of a) if (!b.has(value)) return false\n  return true\n}\n\n/**\n * Hook for reporting in use documents to Presentation\n * @internal\n */\nexport function useReportDocuments(\n  comlink: VisualEditingNode | undefined,\n  elements: ElementState[],\n  perspective: ClientPerspective,\n): void {\n  const lastReported = useRef<\n    | {\n        nodeIds: Set<string>\n        perspective: ClientPerspective\n      }\n    | undefined\n  >(undefined)\n\n  const reportDocuments = useCallback(\n    (documents: ContentSourceMapDocuments, perspective: ClientPerspective) => {\n      comlink?.post('visual-editing/documents', {\n        documents,\n        perspective,\n      })\n    },\n    [comlink],\n  )\n\n  useEffect(() => {\n    // Report only nodes of type `SanityNode`. Untransformed `SanityStegaNode`\n    // nodes without an `id`, are not reported as they will not contain the\n    // necessary document data.\n    const nodes = elements\n      .map((e) => {\n        const {sanity} = e\n        if (!sanity || !('id' in sanity)) return null\n        return sanity\n      })\n      .filter((s) => !!s) as SanityNode[]\n\n    const nodeIds = new Set<string>(nodes.map((e) => e.id))\n    // Report if:\n    // - Documents not yet reported\n    // - Document IDs changed\n    // - Perspective changed\n    if (\n      !lastReported.current ||\n      !isEqualSets(nodeIds, lastReported.current.nodeIds) ||\n      perspective !== lastReported.current.perspective\n    ) {\n      const documentsOnPage: ContentSourceMapDocuments = Array.from(nodeIds).map((_id) => {\n        const node = nodes.find((node) => node.id === _id)!\n        const {type, projectId: _projectId, dataset: _dataset} = node\n        return _projectId && _dataset\n          ? {_id, _type: type!, _projectId, _dataset}\n          : {_id, _type: type!}\n      })\n      lastReported.current = {nodeIds, perspective}\n      reportDocuments(documentsOnPage, perspective)\n    }\n  }, [elements, perspective, reportDocuments])\n}\n","import type {ClientPerspective} from '@sanity/client'\nimport {getDraftId, getPublishedId} from '@sanity/client/csm'\nimport type {Status} from '@sanity/comlink'\nimport {type VisualEditingControllerMsg} from '@sanity/presentation-comlink'\nimport {\n  isHTMLAnchorElement,\n  isHTMLElement,\n  LayerProvider,\n  PortalProvider,\n  studioTheme,\n  ThemeProvider,\n  usePrefersDark,\n} from '@sanity/ui/_visual-editing'\nimport {\n  startTransition,\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n  type FunctionComponent,\n} from 'react'\nimport {styled} from 'styled-components'\nimport {useOptimisticActor, useOptimisticActorReady} from '../react/useOptimisticActor'\nimport type {\n  OverlayComponentResolver,\n  OverlayEventHandler,\n  OverlayMsg,\n  OverlayPluginDefinition,\n  VisualEditingNode,\n} from '../types'\nimport {sanityNodesExistInSameArray} from '../util/findSanityNodes'\nimport {useDragEndEvents} from '../util/useDragEvents'\nimport {ContextMenu} from './context-menu/ContextMenu'\nimport {ElementOverlay} from './ElementOverlay'\nimport {OverlayDragGroupRect} from './OverlayDragGroupRect'\nimport {OverlayDragInsertMarker} from './OverlayDragInsertMarker'\nimport {OverlayDragPreview} from './OverlayDragPreview'\nimport {OverlayMinimapPrompt} from './OverlayMinimapPrompt'\nimport {overlayStateReducer} from './overlayStateReducer'\nimport {PreviewSnapshotsProvider} from './preview/PreviewSnapshotsProvider'\nimport {SchemaProvider} from './schema/SchemaProvider'\nimport {SharedStateProvider} from './shared-state/SharedStateProvider'\nimport {TelemetryProvider} from './telemetry/TelemetryProvider'\nimport {useTelemetry} from './telemetry/useTelemetry'\nimport {useController} from './useController'\nimport {usePerspectiveSync} from './usePerspectiveSync'\nimport {useReportDocuments} from './useReportDocuments'\n\nconst Root = styled.div<{\n  $zIndex?: string | number\n}>`\n  background-color: transparent;\n  direction: ltr;\n  inset: 0;\n  pointer-events: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: ${({$zIndex}) => $zIndex ?? '9999999'};\n`\n\nfunction raf2(fn: () => void) {\n  let r0: number | undefined = undefined\n  let r1: number | undefined = undefined\n\n  r0 = requestAnimationFrame(() => {\n    r1 = requestAnimationFrame(fn)\n  })\n\n  return () => {\n    if (r0 !== undefined) cancelAnimationFrame(r0)\n    if (r1 !== undefined) cancelAnimationFrame(r1)\n  }\n}\n\nconst DocumentReporter: FunctionComponent<{\n  documentIds: string[]\n  perspective: ClientPerspective\n}> = (props) => {\n  const {documentIds} = props\n  const [uniqueIds, setUniqueIds] = useState<string[]>([])\n\n  useEffect(() => {\n    startTransition(() =>\n      setUniqueIds((prev) => {\n        const next = Array.from(new Set(documentIds))\n        return prev.length === next.length &&\n          prev.reduce((acc, prevId) => acc.filter((id) => id !== prevId), next)?.length === 0\n          ? prev\n          : next\n      }),\n    )\n  }, [documentIds])\n  const actor = useOptimisticActor()\n\n  useEffect(() => {\n    for (const id of uniqueIds) {\n      actor.send({type: 'observe', documentId: getDraftId(id)})\n      actor.send({type: 'observe', documentId: getPublishedId(id)})\n    }\n    return () => {\n      for (const id of uniqueIds) {\n        actor.send({type: 'unobserve', documentId: getDraftId(id)})\n        actor.send({type: 'unobserve', documentId: getPublishedId(id)})\n      }\n    }\n  }, [actor, uniqueIds])\n\n  return null\n}\n\nconst OverlaysController: FunctionComponent<{\n  comlink?: VisualEditingNode\n  dispatch: (value: OverlayMsg | VisualEditingControllerMsg) => void\n  inFrame: boolean\n  inPopUp: boolean\n  onDrag: (x: number, y: number) => void\n  overlayEnabled: boolean\n  rootElement: HTMLElement | null\n}> = (props) => {\n  const {comlink, dispatch, inFrame, inPopUp, onDrag, overlayEnabled, rootElement} = props\n  const {dispatchDragEndEvent} = useDragEndEvents()\n  const sendTelemetry = useTelemetry()\n\n  const overlayEventHandler: OverlayEventHandler = useCallback(\n    (message) => {\n      if (message.type === 'element/click') {\n        const {sanity} = message\n        comlink?.post('visual-editing/focus', sanity)\n\n        sendTelemetry('Visual Editing Overlay Clicked', null)\n      } else if (message.type === 'overlay/activate') {\n        comlink?.post('visual-editing/toggle', {enabled: true})\n      } else if (message.type === 'overlay/deactivate') {\n        comlink?.post('visual-editing/toggle', {enabled: false})\n      } else if (message.type === 'overlay/dragEnd') {\n        const {insertPosition, target, dragGroup, flow, preventInsertDefault} = message\n\n        dispatchDragEndEvent({insertPosition, target, dragGroup, flow, preventInsertDefault})\n\n        if (insertPosition) {\n          sendTelemetry('Visual Editing Drag Sequence Completed', null)\n        }\n      } else if (message.type === 'overlay/dragUpdateCursorPosition') {\n        onDrag(message.x, message.y)\n\n        return\n      } else if (message.type === 'overlay/dragToggleMinimap' && message.display === true) {\n        sendTelemetry('Visual Editing Drag Minimap Enabled', null)\n      } else if (message.type === 'overlay/setCursor') {\n        const {element, cursor} = message\n\n        if (cursor) {\n          element.style.cursor = cursor\n        } else {\n          element.style.removeProperty('cursor')\n        }\n      }\n\n      dispatch(message)\n    },\n    [comlink, dispatch, dispatchDragEndEvent, onDrag, sendTelemetry],\n  )\n\n  const controller = useController(rootElement, overlayEventHandler, inFrame, inPopUp)\n\n  useEffect(() => {\n    if (overlayEnabled) {\n      controller.current?.activate()\n    } else {\n      controller.current?.deactivate()\n    }\n  }, [controller, overlayEnabled])\n\n  return null\n}\n\n/**\n * @internal\n */\nexport function Overlays(props: {\n  comlink?: VisualEditingNode\n  comlinkStatus?: Status\n  componentResolver?: OverlayComponentResolver\n  plugins?: OverlayPluginDefinition[]\n  inFrame: boolean\n  inPopUp: boolean\n  zIndex?: string | number\n}): React.JSX.Element {\n  const {\n    comlink,\n    comlinkStatus,\n    componentResolver: _componentResolver,\n    inFrame,\n    inPopUp,\n    zIndex,\n  } = props\n\n  const prefersDark = usePrefersDark()\n\n  const [\n    {\n      contextMenu,\n      dragInsertPosition,\n      dragShowMinimap,\n      dragShowMinimapPrompt,\n      dragSkeleton,\n      elements,\n      isDragging,\n      perspective,\n      wasMaybeCollapsed,\n      dragMinimapTransition,\n      dragGroupRect,\n    },\n    dispatch,\n  ] = useReducer(overlayStateReducer, {\n    contextMenu: null,\n    dragInsertPosition: null,\n    dragShowMinimap: false,\n    dragShowMinimapPrompt: false,\n    dragSkeleton: null,\n    elements: [],\n    focusPath: '',\n    isDragging: false,\n    perspective: 'published',\n    wasMaybeCollapsed: false,\n    dragMinimapTransition: false,\n    dragGroupRect: null,\n  })\n  const [rootElement, setRootElement] = useState<HTMLElement | null>(null)\n  const [overlayEnabled, setOverlayEnabled] = useState(true)\n\n  useEffect(() => {\n    const unsubs = [\n      comlink?.on('presentation/focus', (data) => {\n        dispatch({type: 'presentation/focus', data})\n      }),\n      comlink?.on('presentation/blur', (data) => {\n        dispatch({type: 'presentation/blur', data})\n      }),\n      comlink?.on('presentation/toggle-overlay', () => {\n        setOverlayEnabled((enabled) => !enabled)\n      }),\n    ].filter(Boolean)\n\n    return () => unsubs.forEach((unsub) => unsub!())\n  }, [comlink])\n\n  usePerspectiveSync(comlink, dispatch)\n\n  useReportDocuments(comlink, elements, perspective)\n\n  const updateDragPreviewCustomProps = useCallback(\n    (x: number, y: number) => {\n      if (!rootElement) return\n\n      rootElement.style.setProperty('--drag-preview-x', `${x}px`)\n      rootElement.style.setProperty('--drag-preview-y', `${y - window.scrollY}px`)\n    },\n    [rootElement],\n  )\n\n  useEffect(() => {\n    const handleClick = (event: MouseEvent) => {\n      const target = event.target\n\n      // We only need to modify the default behavior if the target is a link\n      const targetsLink = Boolean(\n        isHTMLAnchorElement(target) || (isHTMLElement(target) && target.closest('a')),\n      )\n\n      if (targetsLink && event.altKey) {\n        event.preventDefault()\n        event.stopPropagation()\n        const newEvent = new MouseEvent(event.type, {\n          ...event,\n          altKey: false,\n          bubbles: true,\n          cancelable: true,\n        })\n        event.target?.dispatchEvent(newEvent)\n      }\n    }\n\n    let altPressed = false\n\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (isAltKey(e) && altPressed) {\n        altPressed = false\n        setOverlayEnabled((enabled) => !enabled)\n      }\n    }\n\n    const handleKeydown = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        // Don't handle Alt if it's part of a complex shortcut\n        if (e.ctrlKey || e.metaKey || e.shiftKey) {\n          return\n        }\n\n        if (!altPressed) {\n          altPressed = true\n          setOverlayEnabled((enabled) => !enabled)\n        }\n      }\n\n      if (isHotkey(['mod', '\\\\'], e)) {\n        setOverlayEnabled((enabled) => !enabled)\n      }\n    }\n\n    // Reset Alt state if window loses focus\n    const handleWindowBlur = () => {\n      if (altPressed) {\n        altPressed = false\n        setOverlayEnabled((enabled) => !enabled) // Toggle back\n      }\n    }\n\n    window.addEventListener('click', handleClick)\n    window.addEventListener('keydown', handleKeydown)\n    window.addEventListener('keyup', handleKeyUp)\n    window.addEventListener('blur', handleWindowBlur)\n\n    return () => {\n      window.removeEventListener('click', handleClick)\n      window.removeEventListener('keydown', handleKeydown)\n      window.removeEventListener('keyup', handleKeyUp)\n      window.removeEventListener('blur', handleWindowBlur)\n    }\n  }, [setOverlayEnabled])\n\n  const [overlaysFlash, setOverlaysFlash] = useState(false)\n  const [fadingOut, setFadingOut] = useState(false)\n  const fadeOutTimeoutRef = useRef<NodeJS.Timeout | undefined>(undefined)\n\n  // Flash overlays when they are enabled\n  useEffect(() => {\n    if (overlayEnabled) {\n      return raf2(() => {\n        setOverlaysFlash(true)\n        raf2(() => {\n          setFadingOut(true)\n          fadeOutTimeoutRef.current = setTimeout(() => {\n            setFadingOut(false)\n            setOverlaysFlash(false)\n          }, 1500)\n        })\n      })\n    } else if (fadeOutTimeoutRef.current) {\n      clearTimeout(fadeOutTimeoutRef.current)\n      startTransition(() => {\n        setOverlaysFlash(false)\n        setFadingOut(false)\n      })\n    }\n\n    return\n  }, [overlayEnabled])\n\n  const documentIds = useMemo(() => {\n    return elements.flatMap((element) => ('id' in element.sanity ? [element.sanity.id] : []))\n  }, [elements])\n\n  const closeContextMenu = useCallback(() => {\n    dispatch({type: 'overlay/blur'})\n  }, [])\n\n  const optimisticActorReady = useOptimisticActorReady()\n\n  const componentResolver = useMemo(() => {\n    return optimisticActorReady ? _componentResolver : undefined\n  }, [_componentResolver, optimisticActorReady])\n\n  /**\n   * 'showActions' is a bit of a misnomer, it only shows the \"Open in Studio\" link, it's separate from the custom overlays and custom actions.\n   * The \"Open in Studio\" link should be visible in all, but one, scenarios:\n   * When inside Presentation Tool, and its preview iframe, it doesn't make sense to show the \"Open in Studio\" link,\n   * since we're already in the studio.\n   */\n  const [shouldHideActions, setShouldHideActions] = useState(false)\n  if (!shouldHideActions && inFrame && comlinkStatus === 'connected') {\n    setShouldHideActions(true)\n  }\n\n  const elementsToRender = useMemo(() => {\n    if (isDragging) {\n      return []\n    }\n\n    return elements\n      .filter((e) => e.activated || e.focused)\n      .map(({id, element, focused, hovered, rect, sanity, dragDisabled, targets, elementType}) => {\n        const draggable =\n          !dragDisabled &&\n          !!element.getAttribute('data-sanity') &&\n          optimisticActorReady &&\n          elements.some((e) =>\n            'id' in e.sanity && 'id' in sanity\n              ? sanityNodesExistInSameArray(e.sanity, sanity) && e.sanity.path !== sanity.path\n              : false,\n          )\n\n        return (\n          <ElementOverlay\n            comlink={comlink}\n            componentResolver={componentResolver}\n            plugins={props.plugins}\n            element={element}\n            enableScrollIntoView={!isDragging && !dragMinimapTransition && !dragShowMinimap}\n            key={id}\n            id={id}\n            focused={focused}\n            hovered={hovered}\n            node={sanity}\n            rect={rect}\n            showActions={!shouldHideActions}\n            draggable={draggable}\n            isDragging={isDragging || dragMinimapTransition}\n            wasMaybeCollapsed={focused && wasMaybeCollapsed}\n            targets={targets}\n            elementType={elementType}\n            inFrame={inFrame}\n          />\n        )\n      })\n  }, [\n    comlink,\n    componentResolver,\n    dragMinimapTransition,\n    dragShowMinimap,\n    elements,\n    inFrame,\n    isDragging,\n    optimisticActorReady,\n    props.plugins,\n    shouldHideActions,\n    wasMaybeCollapsed,\n  ])\n\n  return (\n    <TelemetryProvider comlink={comlink}>\n      <ThemeProvider scheme={prefersDark ? 'dark' : 'light'} theme={studioTheme} tone=\"transparent\">\n        <LayerProvider>\n          <PortalProvider element={rootElement}>\n            <SchemaProvider comlink={comlink} elements={elements}>\n              <PreviewSnapshotsProvider comlink={comlink}>\n                <SharedStateProvider comlink={comlink}>\n                  <Root\n                    data-fading-out={fadingOut ? '' : undefined}\n                    data-overlays={overlaysFlash ? '' : undefined}\n                    ref={setRootElement}\n                    $zIndex={zIndex}\n                  >\n                    <DocumentReporter documentIds={documentIds} perspective={perspective} />\n                    <OverlaysController\n                      comlink={comlink}\n                      dispatch={dispatch}\n                      inFrame={inFrame}\n                      inPopUp={inPopUp}\n                      onDrag={updateDragPreviewCustomProps}\n                      overlayEnabled={overlayEnabled}\n                      rootElement={rootElement}\n                    />\n                    {contextMenu && <ContextMenu {...contextMenu} onDismiss={closeContextMenu} />}\n                    {elementsToRender}\n\n                    {isDragging && !dragMinimapTransition && (\n                      <>\n                        {dragInsertPosition && (\n                          <OverlayDragInsertMarker dragInsertPosition={dragInsertPosition} />\n                        )}\n                        {dragShowMinimapPrompt && <OverlayMinimapPrompt />}\n                        {dragGroupRect && <OverlayDragGroupRect dragGroupRect={dragGroupRect} />}\n                      </>\n                    )}\n                    {isDragging && dragSkeleton && <OverlayDragPreview skeleton={dragSkeleton} />}\n                  </Root>\n                </SharedStateProvider>\n              </PreviewSnapshotsProvider>\n            </SchemaProvider>\n          </PortalProvider>\n        </LayerProvider>\n      </ThemeProvider>\n    </TelemetryProvider>\n  )\n}\n\nconst IS_MAC =\n  typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform)\n\nconst MODIFIERS: Record<string, 'altKey' | 'ctrlKey' | 'metaKey' | 'shiftKey'> = {\n  alt: 'altKey',\n  ctrl: 'ctrlKey',\n  mod: IS_MAC ? 'metaKey' : 'ctrlKey',\n  shift: 'shiftKey',\n}\nfunction isHotkey(keys: string[], event: KeyboardEvent): boolean {\n  return keys.every((key) => {\n    if (MODIFIERS[key]) {\n      return event[MODIFIERS[key]]\n    }\n    return event.key === key.toUpperCase()\n  })\n}\nfunction isAltKey(event: KeyboardEvent): boolean {\n  return event.key === 'Alt'\n}\n","import {useEffect, useRef, type FunctionComponent} from 'react'\nimport type {VisualEditingNode, VisualEditingOptions} from '../types'\n\n/**\n * @internal\n */\nexport const Refresh: FunctionComponent<\n  {\n    comlink: VisualEditingNode\n  } & Required<Pick<VisualEditingOptions, 'refresh'>>\n> = (props) => {\n  const {comlink, refresh} = props\n\n  const manualRefreshRef = useRef(0)\n  const mutationRefreshRef = useRef(0)\n\n  useEffect(\n    () =>\n      comlink.on('presentation/refresh', (data) => {\n        if (data.source === 'manual') {\n          clearTimeout(manualRefreshRef.current)\n          const promise = refresh(data)\n          if (promise === false) return\n          comlink.post('visual-editing/refreshing', data)\n          let timedOut = false\n          manualRefreshRef.current = window.setTimeout(() => {\n            comlink.post('visual-editing/refreshed', data)\n            timedOut = true\n          }, 3000)\n          promise?.finally?.(() => {\n            if (timedOut) return\n            clearTimeout(manualRefreshRef.current)\n            comlink.post('visual-editing/refreshed', data)\n          })\n        } else if (data.source === 'mutation') {\n          clearTimeout(mutationRefreshRef.current)\n          const promise = refresh(data)\n          if (promise === false) return\n          comlink.post('visual-editing/refreshing', data)\n          // Send an additional refresh to account for Content Lake eventual consistency\n          mutationRefreshRef.current = window.setTimeout(() => {\n            const promise = refresh(data)\n            if (promise === false) return\n            comlink.post('visual-editing/refreshing', data)\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n            promise?.finally?.(() => {\n              comlink.post('visual-editing/refreshed', data)\n            }) || comlink.post('visual-editing/refreshed', data)\n          }, 1000)\n          // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n          promise?.finally?.(() => {\n            comlink.post('visual-editing/refreshed', data)\n          }) || comlink.post('visual-editing/refreshed', data)\n        }\n      }),\n    [comlink, refresh],\n  )\n\n  return null\n}\n","import {createNode, createNodeMachine, type Status} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {startTransition, useEffect, useState} from 'react'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * Hook for maintaining a channel between overlays and the presentation tool\n * @internal\n */\nexport function useComlink(active = true): [VisualEditingNode | undefined, Status] {\n  const [node, setNode] = useState<VisualEditingNode>()\n  const [status, setStatus] = useState<Status>('idle')\n\n  useEffect(() => {\n    if (!active) return\n    const instance = createNode<VisualEditingNodeMsg, VisualEditingControllerMsg>(\n      {\n        name: 'visual-editing',\n        connectTo: 'presentation',\n      },\n      createNodeMachine<VisualEditingNodeMsg, VisualEditingControllerMsg>().provide({\n        actors: createCompatibilityActors<VisualEditingNodeMsg>(),\n      }),\n    )\n    const unsub = instance.onStatus(() => setStatus('connected'), 'connected')\n\n    startTransition(() => setNode(instance))\n    const stop = instance.start()\n\n    return () => {\n      unsub()\n      stop()\n      startTransition(() => setNode(undefined))\n    }\n  }, [active])\n\n  /**\n   * Handle reporting of status to the presentation tool in case of connection failure due to misconfigured URL origin\n   */\n  useEffect(() => {\n    /**\n     * We only need to report status if the node is not connected\n     */\n    if (status === 'connected') return\n\n    const controller = new AbortController()\n    window.addEventListener(\n      'message',\n      ({data, origin}: MessageEvent<unknown>) => {\n        /**\n         * Detect if Presentation is asking if Visual Editing is here but misconfigured\n         * @TODO this should probably be a feature built into `comlink`, as it's a common problem for apps dealing with iframes.\n         */\n        if (\n          data &&\n          typeof data === 'object' &&\n          'domain' in data &&\n          data.domain === 'sanity/channels' &&\n          'from' in data &&\n          data.from === 'presentation' &&\n          'type' in data &&\n          data.type === 'presentation/status'\n        ) {\n          /**\n           * We only send this message to the parent window, which supports Presentation loading the page in an iframe.\n           * This avoids letting other iframes on the page, or other openers, from getting a response.\n           */\n          window.parent.postMessage(\n            {\n              domain: 'sanity/channels',\n              type: 'visual-editing/status',\n              data: {origin: location.origin},\n            },\n            /**\n             * Using the same origin ensures that if the parent window don't have the same origin the message won't be sent.\n             * This grants some protection against spoofing, as malicious iframes can't easily call this event and trigger the Presentation Tool to think there's a failing state.\n             */\n            origin,\n          )\n        }\n      },\n      {signal: controller.signal},\n    )\n    return () => {\n      controller.abort()\n    }\n  }, [status])\n\n  return [node, status]\n}\n","import {type ListenEvent} from '@sanity/client'\nimport {merge, ReplaySubject, Subject, type Observable, type ObservedValueOf} from 'rxjs'\nimport type {VisualEditingNode} from '../../types'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype SharedListenEvent = ListenEvent<Record<string, any>>\n\n/**\n * Creates a single, shared, listener EventSource that strems remote mutations, and notifies when it's online (welcome), offline (reconnect).\n */\nexport function createSharedListener(comlink: VisualEditingNode): Observable<SharedListenEvent> {\n  // Welcome events could be received before the listener has been subscribed\n  // to. Using a ReplaySubject will ensure the welcome event is re-emitted when\n  // a new subscriber arrives.\n  const incomingConnection$ = new ReplaySubject<SharedListenEvent>(1)\n  const incomingMutations$ = new Subject<SharedListenEvent>()\n\n  comlink\n    .fetch('visual-editing/snapshot-welcome', undefined, {suppressWarnings: true})\n    .then((data) => {\n      incomingConnection$.next(data.event)\n    })\n    .catch(() => {\n      // Fail silently as the app may be communicating with a version of\n      // Presentation that does not support this feature\n    })\n\n  comlink.on('presentation/snapshot-event', (data) => {\n    // Welcome events are still emitted by Presentation for backwards\n    // compatibility. We don't need them anymore as we explicitly fetch the\n    // welcome event, so filter them out here.\n    if (data.event.type === 'reconnect') {\n      incomingConnection$.next(data.event)\n    }\n    if (data.event.type === 'mutation') {\n      incomingMutations$.next(data.event)\n    }\n  })\n\n  return merge(incomingConnection$, incomingMutations$)\n}\n\nexport type SharedListenerEvents = ObservedValueOf<ReturnType<typeof createSharedListener>>\n","/* eslint-disable @typescript-eslint/no-empty-function */\nimport {useEffect} from 'react'\nimport {createActor} from 'xstate'\nimport {setActor} from '../optimistic/context'\nimport {createSharedListener} from '../optimistic/state/createSharedListener'\nimport {createDatasetMutator} from '../optimistic/state/datasetMutator'\nimport type {VisualEditingNode} from '../types'\n\n/**\n * Hook for maintaining a channel between overlays and the presentation tool\n * @internal\n */\nexport function useDatasetMutator(comlink: VisualEditingNode | undefined): void {\n  useEffect(() => {\n    if (!comlink) return\n    const listener = createSharedListener(comlink)\n    const datasetMutator = createDatasetMutator(comlink)\n    const mutator = createActor(datasetMutator, {\n      // @ts-expect-error @todo\n      input: {client: {withConfig: () => {}}, sharedListener: listener},\n    })\n\n    mutator.start()\n\n    // Fetch features to determine if optimistic updates are supported\n    const featuresFetch = new AbortController()\n    comlink\n      .fetch('visual-editing/features', undefined, {\n        signal: featuresFetch.signal,\n        suppressWarnings: true,\n      })\n      .then((data) => {\n        if (data.features['optimistic']) {\n          setActor(mutator)\n        }\n      })\n      .catch(() => {\n        // eslint-disable-next-line no-console\n        console.warn(\n          '[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.',\n        )\n      })\n\n    return () => {\n      mutator.stop()\n      featuresFetch.abort()\n    }\n  }, [comlink])\n}\n","import {isMaybePreviewIframe, isMaybePreviewWindow} from '@sanity/presentation-comlink'\nimport {startTransition, useEffect, useState} from 'react'\nimport {createPortal} from 'react-dom'\nimport type {VisualEditingOptions} from '../types'\nimport {History} from './History'\nimport {Meta} from './Meta'\nimport {Overlays} from './Overlays'\nimport {Refresh} from './Refresh'\nimport {useComlink} from './useComlink'\nimport {useDatasetMutator} from './useDatasetMutator'\n\n/**\n * @public\n */\nexport const VisualEditing = (props: VisualEditingOptions & {portal: boolean}): React.ReactNode => {\n  const {components, plugins, history, portal = true, refresh, zIndex} = props\n\n  const [inFrame, setInFrame] = useState<boolean | null>(null)\n  const [inPopUp, setInPopUp] = useState<boolean | null>(null)\n  useEffect(() => {\n    startTransition(() => {\n      setInFrame(isMaybePreviewIframe())\n      setInPopUp(isMaybePreviewWindow())\n    })\n  }, [])\n\n  const [portalElement, setPortalElement] = useState<HTMLElement | null>(null)\n  useEffect(() => {\n    if (portal === false) return undefined\n    const node = document.createElement('sanity-visual-editing')\n    document.documentElement.appendChild(node)\n    startTransition(() => setPortalElement(node))\n    return () => {\n      startTransition(() => setPortalElement(null))\n      if (document.documentElement.contains(node)) {\n        document.documentElement.removeChild(node)\n      }\n    }\n  }, [portal])\n\n  const [comlink, comlinkStatus] = useComlink(inFrame === true || inPopUp === true)\n  useDatasetMutator(comlinkStatus === 'connected' ? comlink : undefined)\n\n  const children = (\n    <>\n      {inFrame !== null && inPopUp !== null && (\n        <Overlays\n          comlink={comlink}\n          comlinkStatus={comlinkStatus}\n          componentResolver={components}\n          plugins={plugins}\n          inFrame={inFrame}\n          inPopUp={inPopUp}\n          zIndex={zIndex}\n        />\n      )}\n      {comlink && (\n        <>\n          <History comlink={comlink} history={history} />\n          <Meta comlink={comlink} />\n          {refresh && <Refresh comlink={comlink} refresh={refresh} />}\n        </>\n      )}\n    </>\n  )\n\n  if (portal === false || !portalElement) return children\n\n  return createPortal(children, portalElement)\n}\nVisualEditing.displayName = 'VisualEditing'\n"],"names":["History","props","$","_c","comlink","history","t0","t1","on","data","update","useEffect","t2","t3","subscribe","title","document","post","Meta","sendMeta","observer","MutationObserver","mutation","target","nodeName","observe","head","subtree","characterData","childList","disconnect","getReferenceNodeAndInsertPosition","position","top","right","bottom","left","node","sanity","useDragEndEvents","getDocument","useDocuments","handler","e","insertPosition","preventInsertDefault","detail","reference","doc","id","key","targetKey","hasExplicitKey","getArrayItemKeyAndParentPath","path","arrayPath","referenceItemKey","patch","getSnapshot","snapshot","elementValue","getFromPath","at","remove","_key","insert","window","addEventListener","removeEventListener","dispatchDragEndEvent","_temp","Symbol","for","event","customEvent","CustomEvent","cancelable","dispatchEvent","SchemaContext","createContext","useSchema","context","useContext","Error","getArrayRemoveAction","type","getArrayRemovePatches","getArrayInsertAction","insertType","getArrayInsertPatches","getDuplicateAction","getArrayDuplicatePatches","getContextMenuItems","field","parent","getContextMenuArrayItems","getContextMenuUnionItems","Promise","resolve","getDuplicateItem","label","icon","CopyIcon","action","telemetryEvent","getRemoveItems","RemoveIcon","getMoveItems","withDivider","items","groupItems","moveUpPatches","moveDownPatches","moveFirstPatches","moveLastPatches","all","getArrayMovePatches","length","push","PublishIcon","ArrowUpIcon","ArrowDownIcon","UnpublishIcon","SortIcon","InsertAboveIcon","name","InsertBelowIcon","InsertMenuWrapper","width","onSelect","boundaryElement","arrow","constrainSize","floatingBoundary","padding","placement","fallbackPlacements","preventOverflow","__unstable_margins","t4","options","insertMenu","views","some","view","undefined","component","sendTelemetry","schemaType","of","filter","item","map","t","getNodeIcon","POPOVER_MARGINS","ContextMenuItem","onDismiss","useTelemetry","onClick","hotkeys","t5","itemIndex","Component","ContextMenu","x","y","setBoundaryElement","useState","getField","setItems","fetchContextMenuItems","items_0","getBoundingClientRect","height","contextMenuReferenceElement","t6","minWidth","maxWidth","t7","t8","t9","t10","t11","i","t12","t13","t14","t15","t16","t17","getLinkHref","href","referer","parsed","URL","location","origin","hash","slice","pathname","search","searchParams","set","toString","PreviewSnapshotsContext","usePreviewSnapshots","isReactElementOverlayComponent","isValidElement","Root","styled","Card","Actions","Flex","HUD","MenuWrapper","Tab","ActionOpen","Labels","ExclusivePluginContainer","div","createIntentLink","baseUrl","tool","workspace","perspective","url","createEditUrl","pathToUrlString","studioPath","fromString","split","URLSearchParams","resolvedPerspective","get","delete","ElementOverlayInner","element","focused","componentResolver","showActions","draggable","targets","elementType","onActivateExclusivePlugin","onMenuOpenChange","inFrame","getType","previewSnapshots","bb0","find","_id","node_0","nodeElement","schemaType_0","value","targetElement","getContext","legacyComponentContext","pluginContexts","resolverContexts","customComponents","useCustomComponents","nodePluginCollections","useResolvedNodePlugins","plugins","__html","menuId","useId","_temp2","showMenu","handleLabelClick","_temp3","animate","tone","EllipsisVerticalIcon","nodePluginCollection_0","index","Fragment","textTransform","nodePluginCollection","exclusive","MenuDivider","_temp4","Array","isArray","Component_1","props_0","PointerEvents","ElementOverlay","memo","hovered","rect","wasMaybeCollapsed","enableScrollIntoView","ref","useRef","scrolledIntoViewRef","w","h","transform","style","current","scrollIntoView","behavior","actions","block","inline","scrollMode","isNearTop","setIsNearTop","io","IntersectionObserver","intersection","boundingClientRect","threshold","activeExclusivePlugin","setActiveExclusivePlugin","closeExclusivePluginView","plugin","handleExclusivePluginClick","_temp5","ExclusivePluginComponent","menuOpen","setMenuOpen","startTransition","t18","t19","t20","componentContexts","componentContext","instance","uuid","hud","forEach","guard","resolved","_temp6","Link","useSyncExternalStore","_temp7","_temp8","ctx","stopPropagation","nodePluginCollection_1","Component_0","onStoreChange","handlePopState","OverlayDragGroupRect","dragGroupRect","border","pointerEvents","markerThickness","lerp","v0","v1","OverlayDragInsertMarker","dragInsertPosition","flow","startX","endX","offset","Math","min","offset_0","offset_1","startX_0","startY","endY","offset_2","max","offset_3","offset_4","background","borderRadius","zIndex","$scaleFactor","$width","$height","clamp","number","inMin","inMax","outMin","outMax","mapped","OverlayDragPreview","skeleton","maxSkeletonWidth","innerWidth","scaleFactor","offsetX","offsetY","prefersDark","usePrefersDark","theme","useTheme_v2","radius","T0","T1","childRects","imageRects","textRects","color","r_1","r","from","tagName","r_0","OverlayMinimapPrompt","elementsReducer","elements","message","activated","dragDisabled","clickedElement","overlayStateReducer","state","contextMenu","focusPath","isDragging","dragShowMinimap","dragShowMinimapPrompt","dragSkeleton","dragMinimapTransition","prevFocusPath","startsWith","display","groupRect","PreviewSnapshotsProvider","children","setPreviewSnapshots","signal","response","fetch","suppressWarnings","snapshots","fetchPreviewSnapshots","previewSapshotsFetch","AbortController","unsub","onStatus","abort","isSanityNode","isDocumentSchemaType","isTypeSchemaType","popUnkeyedPathSegments","toReversed","reduce","acc","part","includes","join","getPathsWithUnresolvedTypes","SchemaProvider","Map","resolvedTypes","setResolvedTypes","schema","setSchema","fetchSchema","schemaFetch","reportedPathsRef","useDeferredValue","paths","controllerRef","reportPaths","paths_0","signal_0","initialReportedPaths","response_0","aborted","types","p","_type","fieldFromPath","schemaType_1","path_0","prevPath","next","rest","objectField","fields","name_0","Boolean","type_0","nodePath","flatMap","console","warn","createStore","initialState","getState","listeners","Set","setState","fn","l","listener","add","store","SharedStateProvider","catch","value_0","prev","prev_0","Object","fromEntries","entries","reason","debug","TelemetryProvider","events","log","useController","inPopUp","overlayController","optimisticActorReady","useOptimisticActorReady","createOverlayController","overlayElement","destroy","usePerspectiveSync","dispatch","controller","then","data_0","isEqualSets","a","b","size","has","useReportDocuments","lastReported","documents","perspective_0","reportDocuments","nodes","nodeIds","documentsOnPage","projectId","_projectId","dataset","_dataset","e_0","s","$zIndex","raf2","r0","r1","requestAnimationFrame","cancelAnimationFrame","DocumentReporter","documentIds","uniqueIds","setUniqueIds","actor","useOptimisticActor","id_0","send","documentId","getDraftId","getPublishedId","id_1","OverlaysController","onDrag","overlayEnabled","rootElement","enabled","dragGroup","cursor","removeProperty","activate","deactivate","Overlays","comlinkStatus","_componentResolver","useReducer","setRootElement","setOverlayEnabled","unsubs","setProperty","scrollY","updateDragPreviewCustomProps","handleClick","altPressed","handleKeyUp","isAltKey","handleKeydown","ctrlKey","metaKey","shiftKey","isHotkey","handleWindowBlur","overlaysFlash","setOverlaysFlash","fadingOut","setFadingOut","fadeOutTimeoutRef","setTimeout","clearTimeout","_temp9","closeContextMenu","shouldHideActions","setShouldHideActions","_temp0","element_0","getAttribute","e_2","sanityNodesExistInSameArray","elementsToRender","t21","t22","t23","t24","t25","studioTheme","t26","e_1","enabled_3","enabled_2","enabled_1","enabled_0","isHTMLAnchorElement","isHTMLElement","closest","altKey","preventDefault","newEvent","MouseEvent","bubbles","IS_MAC","test","navigator","platform","MODIFIERS","alt","ctrl","mod","shift","keys","every","toUpperCase","prevId","Refresh","refresh","manualRefreshRef","mutationRefreshRef","source","promise","timedOut","finally","promise_0","promise_1","useComlink","active","setNode","status","setStatus","createNode","connectTo","createNodeMachine","provide","actors","createCompatibilityActors","stop","start","domain","postMessage","createSharedListener","incomingConnection$","ReplaySubject","incomingMutations$","Subject","merge","useDatasetMutator","datasetMutator","createDatasetMutator","mutator","createActor","input","client","withConfig","sharedListener","featuresFetch","features","optimistic","setActor","VisualEditing","components","portal","setInFrame","setInPopUp","isMaybePreviewIframe","isMaybePreviewWindow","portalElement","setPortalElement","createElement","documentElement","appendChild","contains","removeChild","createPortal","displayName"],"mappings":"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"}},
    {"offset": {"line": 2840, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@sanity/visual-editing/dist/_chunks-es/renderVisualEditing.js","sources":["file:///C:/Users/quinc/OneDrive/Desktop/Websites/Digicampus/digicampus-next.js-sanity/node_modules/%40sanity/visual-editing/src/ui/renderVisualEditing.tsx"],"sourcesContent":["/**\n * The purpose of this file is to contain the logic for rendering the <VisualEditing />\n * component in a way that is easy to lazy load for the `enableVisualEditing` function.\n */\n\nimport {StrictMode} from 'react'\nimport {createRoot, type Root} from 'react-dom/client'\nimport type {VisualEditingOptions} from '../types'\nimport {VisualEditing} from './VisualEditing'\n\nlet node: HTMLElement | null = null\nlet root: Root | null = null\nlet cleanup: ReturnType<typeof setTimeout> | null = null\n\nexport function renderVisualEditing(\n  signal: AbortSignal,\n  {components, history, refresh, zIndex, plugins}: VisualEditingOptions,\n): void {\n  // Cancel pending cleanups, this is useful to avoid overlays blinking as the parent app transition between URLs, or hot module reload is happening\n  if (cleanup) clearTimeout(cleanup)\n  // Setup a cleanup function listener right away, as the signal might abort in-between the next steps\n  signal.addEventListener('abort', () => {\n    // Handle React StrictMode, delay cleanup for a second in case it's a rerender\n    cleanup = setTimeout(() => {\n      if (root) {\n        root.unmount()\n        root = null\n      }\n      if (node) {\n        node.parentNode!.removeChild(node)\n\n        node = null\n      }\n    }, 1000)\n  })\n\n  if (!node) {\n    node = document.createElement('sanity-visual-editing')\n    // render sanity-visual-editing after closing </body> tag\n    document.body.parentNode!.insertBefore(node, document.body.nextSibling)\n  }\n\n  if (!root) {\n    root = createRoot(node)\n  }\n\n  root.render(\n    <StrictMode>\n      <VisualEditing\n        components={components}\n        plugins={plugins}\n        history={history}\n        refresh={refresh}\n        zIndex={zIndex}\n        // Disabling the portal, as this function is already making sure the overlays render in the right spot\n        portal={false}\n      />\n    </StrictMode>,\n  )\n}\n"],"names":["node","root","cleanup","renderVisualEditing","signal","components","history","refresh","zIndex","plugins","clearTimeout","addEventListener","setTimeout","unmount","parentNode","removeChild","document","createElement","body","insertBefore","nextSibling","createRoot","render"],"mappings":";;;;;;;;;;;;AAUA,IAAIA,OAA2B,MAC3BC,OAAoB,MACpBC,UAAgD;AAE7C,SAASC,oBACdC,MAAAA,EACA,EAACC,UAAAA,EAAYC,OAAAA,EAASC,OAAAA,EAASC,MAAAA,EAAQC,OAAAA,EAA6B,EAC9D;IAEFP,WAASQ,aAAaR,OAAO,GAEjCE,OAAOO,gBAAAA,CAAiB,SAAS,MAAM;QAErCT,UAAUU,WAAW,MAAM;YACrBX,QAAAA,CACFA,KAAKY,OAAAA,CAAAA,GACLZ,OAAO,IAAA,GAELD,QAAAA,CACFA,KAAKc,UAAAA,CAAYC,WAAAA,CAAYf,IAAI,GAEjCA,OAAO,IAAA;QAEX,GAAG,GAAI;IACT,CAAC,GAEIA,QAAAA,CACHA,OAAOgB,SAASC,aAAAA,CAAc,uBAAuB,GAErDD,SAASE,IAAAA,CAAKJ,UAAAA,CAAYK,YAAAA,CAAanB,MAAMgB,SAASE,IAAAA,CAAKE,WAAW,CAAA,GAGnEnB,QAAAA,CACHA,WAAOoB,mLAAAA,EAAWrB,IAAI,CAAA,GAGxBC,KAAKqB,MAAAA,CACH,aAAA,GAAA,IAAA,6KAAA,EAAC,2KAAA,EAAA;QACC,UAAA,aAAA,GAAA,IAAA,6KAAA,EAAC,2MAAA,EAAA;YACC;YACA;YACA;YACA;YACA;YAEA,QAAQ,CAAA;QAAA;IAAA,CAEZ,CACF;AACF"}}]
}